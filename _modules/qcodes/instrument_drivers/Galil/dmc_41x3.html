<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qcodes.instrument_drivers.Galil.dmc_41x3 &mdash; QCoDeS 0.27.0.dev9139 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=9e84aeb3"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            QCoDeS
          </a>
              <div class="version">
                0.27.0.dev9139+main.g009ec80fb
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/15_minutes_to_QCoDeS.html">15 minutes to QCoDeS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/index.html">Examples of using QCoDeS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/index.html">QCoDes API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../drivers_api/index.html">Instrument Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help.html">Get Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">QCoDeS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">qcodes.instrument_drivers.Galil.dmc_41x3</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for qcodes.instrument_drivers.Galil.dmc_41x3</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file holds the QCoDeS driver for the Galil DMC-41x3 motor controllers.</span>

<span class="sd">Colloquially known as the &quot;stepper motors&quot;.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.typing</span> <span class="k">as</span> <span class="nn">npt</span>

<span class="kn">from</span> <span class="nn">qcodes.instrument</span> <span class="kn">import</span> <span class="n">Instrument</span><span class="p">,</span> <span class="n">InstrumentBaseKWArgs</span><span class="p">,</span> <span class="n">InstrumentChannel</span>
<span class="kn">from</span> <span class="nn">qcodes.validators</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">Ints</span><span class="p">,</span> <span class="n">Multiples</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Unpack</span>

    <span class="kn">from</span> <span class="nn">qcodes.parameters</span> <span class="kn">import</span> <span class="n">Parameter</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">gclib</span>  <span class="c1"># pyright: ignore[reportMissingImports]</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
        <span class="s2">&quot;Cannot find gclib library. Download gclib installer from &quot;</span>
        <span class="s2">&quot;https://www.galil.com/sw/pub/all/rn/gclib.html and install Galil &quot;</span>
        <span class="s2">&quot;motion controller software for your OS. Afterwards go &quot;</span>
        <span class="s2">&quot;to https://www.galil.com/sw/pub/all/doc/gclib/html/python.html and &quot;</span>
        <span class="s2">&quot;follow instruction to be able to import gclib package in your &quot;</span>
        <span class="s2">&quot;environment.&quot;</span>
    <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>


<span class="k">class</span> <span class="nc">GalilMotionController</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for Galil Motion Controller drivers</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s2">&quot;Unpack[InstrumentBaseKWArgs]&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes and opens the connection to the Galil Motion Controller</span>

<span class="sd">        Args:</span>
<span class="sd">            name: name for the instrument</span>
<span class="sd">            address: address of the controller</span>
<span class="sd">            **kwargs: kwargs are forwarded to base class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">gclib</span><span class="o">.</span><span class="n">py</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_message</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open connection to Galil motion controller. This method assumes that</span>
<span class="sd">        the initial mapping of Galil motion controller&#39;s hardware&#39;s</span>
<span class="sd">        to an IP address is done using GDK and the IP address is burned in.</span>
<span class="sd">        This applies that Motion controller no more requests for an IP address</span>
<span class="sd">        and a connection to the Motion controller can be done by the IP</span>
<span class="sd">        address burned in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span> <span class="o">+</span> <span class="s2">&quot; --direct -s ALL&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_idn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get Galil motion controller hardware information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GInfo</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">idparts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Galil Motion Control, Inc.&quot;</span><span class="p">,</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s2">&quot;vendor&quot;</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;serial&quot;</span><span class="p">,</span> <span class="s2">&quot;firmware&quot;</span><span class="p">),</span> <span class="n">idparts</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write for Galil motion controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GCommand</span><span class="p">(</span><span class="n">cmd</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ask_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Asks/Reads data from Galil motion controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GCommand</span><span class="p">(</span><span class="n">cmd</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets timeout for the instrument</span>

<span class="sd">        Args:</span>
<span class="sd">            val: time in milliseconds. -1 disables the timeout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Timeout value cannot be set less than -1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GTimeout</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close connection to the instrument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GClose</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">motion_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wait for motion to complete for given axes, e.g. ``&quot;A&quot;``</span>
<span class="sd">        for axis A, ``&quot;ABC&quot;`` for axes A, B, and C</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">GMotionComplete</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>


<div class="viewcode-block" id="GalilDMC4133VectorMode">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode">[docs]</a>
<span class="k">class</span> <span class="nc">GalilDMC4133VectorMode</span><span class="p">(</span><span class="n">InstrumentChannel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to control motors in vector mode</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;GalilDMC4133Controller&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s2">&quot;Unpack[InstrumentBaseKWArgs]&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the vector mode submodule for the controller</span>

<span class="sd">        Args:</span>
<span class="sd">            parent: an instance of DMC4133Controller</span>
<span class="sd">            name: name of the vector mode plane</span>
<span class="sd">            **kwargs: kwargs are forwarded to base class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plane</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vector_position_validator</span> <span class="o">=</span> <span class="n">Ints</span><span class="p">(</span>
            <span class="n">min_value</span><span class="o">=-</span><span class="mi">2147483648</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">2147483647</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;coordinate_system&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;CA ?&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parse_coordinate_system_active</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;CA </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;activates coordinate system for the motion. Two &quot;</span>
            <span class="s2">&quot; coordinate systems are possible with values &quot;</span>
            <span class="s2">&quot;&#39;S&#39; and &#39;T&#39;. All vector mode commands will apply to &quot;</span>
            <span class="s2">&quot;the active coordinate system.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;activates coordinate system for the motion. Two  coordinate systems are possible with values &#39;S&#39; and &#39;T&#39;. All vector mode commands will apply to the active coordinate system.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vector_acceleration</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;vector_acceleration&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;VA ?&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;VA </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">1073740800</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1024</span><span class="p">),</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;counts/sec2&quot;</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;sets and gets the defined vector&#39;s acceleration&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sets and gets the defined vector&#39;s acceleration&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vector_deceleration</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;vector_deceleration&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;VD ?&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;VD </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">1073740800</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1024</span><span class="p">),</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;counts/sec2&quot;</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;sets and gets the defined vector&#39;s deceleration&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sets and gets the defined vector&#39;s deceleration&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vector_speed</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;vector_speed&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;VS ?&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;VS </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">15000000</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;counts/sec&quot;</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;sets and gets defined vector&#39;s speed&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sets and gets defined vector&#39;s speed&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_coordinate_system_active</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        parses the current active coordinate system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s2">&quot;T&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;S&quot;</span>

<div class="viewcode-block" id="GalilDMC4133VectorMode.activate">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode.activate">[docs]</a>
    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        activate plane of motion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_plane</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133VectorMode.vector_position">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode.vector_position">[docs]</a>
    <span class="k">def</span> <span class="nf">vector_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_coord</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">second_coord</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the final vector position for the motion considering current</span>
<span class="sd">        position as the origin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vector_position_validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">first_coord</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vector_position_validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">second_coord</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VP </span><span class="si">{</span><span class="n">first_coord</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">second_coord</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133VectorMode.vector_seq_end">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode.vector_seq_end">[docs]</a>
    <span class="k">def</span> <span class="nf">vector_seq_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        indicates to the controller that the end of the vector is coming up.</span>
<span class="sd">        is required to exit the vector mode gracefully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;VE&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133VectorMode.begin_seq">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode.begin_seq">[docs]</a>
    <span class="k">def</span> <span class="nf">begin_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        begins motion of the motor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;BG S&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133VectorMode.after_seq_motion">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode.after_seq_motion">[docs]</a>
    <span class="k">def</span> <span class="nf">after_seq_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        wait till motion ends</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;AM S&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133VectorMode.clear_sequence">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133VectorMode.clear_sequence">[docs]</a>
    <span class="k">def</span> <span class="nf">clear_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord_sys</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        clears vectors specified in the given coordinate system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">coord_sys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;possible coordinate systems are &#39;S&#39; or &#39;T&#39;. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;you provided the following value instead: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot; &#39;</span><span class="si">{</span><span class="n">coord_sys</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CS </span><span class="si">{</span><span class="n">coord_sys</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<span class="n">VectorMode</span> <span class="o">=</span> <span class="n">GalilDMC4133VectorMode</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Alias for backwards compatibility</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="GalilDMC4133Motor">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor">[docs]</a>
<span class="k">class</span> <span class="nc">GalilDMC4133Motor</span><span class="p">(</span><span class="n">InstrumentChannel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to control a single motor (independent of possible other motors)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;GalilDMC4133Controller&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s2">&quot;Unpack[InstrumentBaseKWArgs]&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes individual motor submodules</span>

<span class="sd">        Args:</span>
<span class="sd">            parent: an instance of DMC4133Controller</span>
<span class="sd">            name: name of the motor to be controlled</span>
<span class="sd">            **kwargs: kwargs are forwarded to base class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axis</span> <span class="o">=</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">relative_position</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;relative_position&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;quadrature counts&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MG _PR</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_relative_position</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;sets relative position for the motor&#39;s move&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sets relative position for the motor&#39;s move&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;speed&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;counts/sec&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MG _SP</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_speed</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">3000000</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;speed for motor&#39;s motion&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;speed for motor&#39;s motion&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">acceleration</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;acceleration&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;counts/sec2&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MG _AC</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_acceleration</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">1073740800</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1024</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;acceleration for motor&#39;s motion&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;acceleration for motor&#39;s motion&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">deceleration</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;deceleration&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;counts/sec2&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MG _DC</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_deceleration</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">1073740800</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1024</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;deceleration for motor&#39;s motion&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;deceleration for motor&#39;s motion&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">off_when_error_occurs</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;off_when_error_occurs&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_off_when_error_occurs</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_off_when_error_occurs</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;disable&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;enable for position, amp error or abort&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;enable for hw limit switch&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;enable for all&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;enables or disables the motor to &quot;</span>
            <span class="s2">&quot;automatically turn off when error occurs&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;enables or disables the motor to automatically turn off when error occurs&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reverse_sw_limit</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;reverse_sw_limit&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;quadrature counts&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MG _BL</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_reverse_sw_limit</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;can be used to set software reverse limit for the motor.&quot;</span>
            <span class="s2">&quot; motor motion will stop beyond this limit automatically.&quot;</span>
            <span class="s2">&quot; default value is -2147483648. this value effectively &quot;</span>
            <span class="s2">&quot;disables the reverse limit.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;can be used to set software reverse limit for the motor. motor motion will stop beyond this limit automatically. default value is -2147483648. this value effectively disables the reverse limit.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">forward_sw_limit</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;forward_sw_limit&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;quadrature counts&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MG _FL</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_forward_sw_limit</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="o">-</span><span class="mi">2147483648</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;can be used to set software forward limit for the motor.&quot;</span>
            <span class="s2">&quot; motor motion will stop beyond this limit automatically.&quot;</span>
            <span class="s2">&quot; default value is 2147483647. this value effectively &quot;</span>
            <span class="s2">&quot;disables the forward limit.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;can be used to set software forward limit for the motor. motor motion will stop beyond this limit automatically. default value is 2147483647. this value effectively disables the forward limit.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_reverse_sw_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets reverse software limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BL</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_forward_sw_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets forward software limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FL</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_off_when_error_occurs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the status if motor is automatically set to turn off when error</span>
<span class="sd">        occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MG _OE</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_set_off_when_error_occurs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the motor to turn off automatically when the error occurs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OE</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_deceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set deceleration for the motor&#39;s motion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DC</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_acceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set acceleration for the motor&#39;s motion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AC</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets speed for motor&#39;s motion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SP</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_relative_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets relative position</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PR</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GalilDMC4133Motor.off">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.off">[docs]</a>
    <span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        turns motor off</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MO </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Motor.on_off_status">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.on_off_status">[docs]</a>
    <span class="k">def</span> <span class="nf">on_off_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        tells motor on off status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MG _MO</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;off&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;on&quot;</span></div>


<div class="viewcode-block" id="GalilDMC4133Motor.servo_here">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.servo_here">[docs]</a>
    <span class="k">def</span> <span class="nf">servo_here</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        servo at the motor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SH </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Motor.begin">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.begin">[docs]</a>
    <span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        begins motion of the motor (returns immediately)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BG </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Motor.is_in_motion">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.is_in_motion">[docs]</a>
    <span class="k">def</span> <span class="nf">is_in_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        checks if the motor is in motion or not. return 1, if motor is in</span>
<span class="sd">        motion otherwise 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MG _BG</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)))</span></div>


<div class="viewcode-block" id="GalilDMC4133Motor.wait_till_motor_motion_complete">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.wait_till_motor_motion_complete">[docs]</a>
    <span class="k">def</span> <span class="nf">wait_till_motor_motion_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        wait for motion on the motor to complete</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_in_motion</span><span class="p">():</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">abort</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">off</span><span class="p">()</span></div>


<div class="viewcode-block" id="GalilDMC4133Motor.error_magnitude">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Motor.error_magnitude">[docs]</a>
    <span class="k">def</span> <span class="nf">error_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gives the magnitude of error, in quadrature counts, for this motor</span>
<span class="sd">        a count is directly proportional to the micro-stepping</span>
<span class="sd">        resolution of the stepper drive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QS</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_axis</span><span class="si">}</span><span class="s2">=?&quot;</span><span class="p">))</span></div>
</div>



<span class="n">Motor</span> <span class="o">=</span> <span class="n">GalilDMC4133Motor</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Alias for backwards compatibility</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="GalilDMC4133Controller">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller">[docs]</a>
<span class="k">class</span> <span class="nc">GalilDMC4133Controller</span><span class="p">(</span><span class="n">GalilMotionController</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Driver for Galil DMC-4133 Controller</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s2">&quot;Unpack[InstrumentBaseKWArgs]&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the DMC4133Controller class</span>

<span class="sd">        Args:</span>
<span class="sd">            name: name for the instance</span>
<span class="sd">            address: address of the controller burned in</span>
<span class="sd">            **kwargs: kwargs are forwarded to base class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">position_format_decimals</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;position_format_decimals&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;PF 10.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;sets number of decimals in the format of the position&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;sets number of decimals in the format of the position&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;absolute_position&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_absolute_position</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;quadrature counts&quot;</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;gets absolute position of the motors from the set origin&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;gets absolute position of the motors from the set origin&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;wait&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;WT </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Multiples</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">2147483646</span><span class="p">,</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;controller will wait for the amount of &quot;</span>
            <span class="s2">&quot;time specified before executing the next &quot;</span>
            <span class="s2">&quot;command&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;controller will wait for the amount of time specified before executing the next command&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_default_update_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;motor_a&quot;</span><span class="p">,</span> <span class="n">GalilDMC4133Motor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;motor_b&quot;</span><span class="p">,</span> <span class="n">GalilDMC4133Motor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;motor_c&quot;</span><span class="p">,</span> <span class="n">GalilDMC4133Motor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;plane_ab&quot;</span><span class="p">,</span> <span class="n">GalilDMC4133VectorMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;AB&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;plane_bc&quot;</span><span class="p">,</span> <span class="n">GalilDMC4133VectorMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BC&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;plane_ac&quot;</span><span class="p">,</span> <span class="n">GalilDMC4133VectorMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;AC&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_default_update_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets sampling period to default value of 1000. sampling period affects</span>
<span class="sd">        the AC, AS, AT, DC, FA, FV, HV, JG, KP, NB, NF, NZ, PL, SD, SP, VA,</span>
<span class="sd">        VD, VS, WT commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;TM 1000&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_absolute_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets absolution position of the motors from the defined origin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;PA ?,?,?&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="GalilDMC4133Controller.end_program">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.end_program">[docs]</a>
    <span class="k">def</span> <span class="nf">end_program</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ends the program</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;EN&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.define_position_as_origin">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.define_position_as_origin">[docs]</a>
    <span class="k">def</span> <span class="nf">define_position_as_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        defines current motors position as origin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;DP 0,0,0&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.tell_error">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.tell_error">[docs]</a>
    <span class="k">def</span> <span class="nf">tell_error</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reads error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;TC1&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.stop">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.stop">[docs]</a>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        stop the motion of all motors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ST&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.abort">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.abort">[docs]</a>
    <span class="k">def</span> <span class="nf">abort</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        aborts motion and the program operation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;AB&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.motors_off">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.motors_off">[docs]</a>
    <span class="k">def</span> <span class="nf">motors_off</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        turn all motors off</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;MO&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.begin_motors">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.begin_motors">[docs]</a>
    <span class="k">def</span> <span class="nf">begin_motors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        begin motion of all motors simultaneously</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;BG&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Controller.wait_till_motion_complete">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Controller.wait_till_motion_complete">[docs]</a>
    <span class="k">def</span> <span class="nf">wait_till_motion_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this method waits for the motion on all motors to complete</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;MG _BGA&quot;</span><span class="p">)))</span>
                <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;MG _BGB&quot;</span><span class="p">)))</span>
                <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;MG _BGC&quot;</span><span class="p">)))</span>
            <span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abort</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motors_off</span><span class="p">()</span></div>
</div>



<span class="n">DMC4133Controller</span> <span class="o">=</span> <span class="n">GalilDMC4133Controller</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Alias for backwards compatibility</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="GalilDMC4133Arm">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm">[docs]</a>
<span class="k">class</span> <span class="nc">GalilDMC4133Arm</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Module to control probe arm. It is assumed that the chip to be probed has</span>
<span class="sd">    one or more rows with each row having one or more pads. Design of the</span>
<span class="sd">    chip to be probed should resemble the following::</span>

<span class="sd">        |--------------------------|</span>
<span class="sd">        |--------------------------|</span>
<span class="sd">        |--------------------------|</span>
<span class="sd">        |--------------------------|</span>
<span class="sd">        |--------------------------|</span>

<span class="sd">    Needle head for the arm in assumed to have rows of needles which is a</span>
<span class="sd">    divisor of the number of rows in the chip and number of needles in each</span>
<span class="sd">    row of the needle head is a divisor for the number of pads in each row</span>
<span class="sd">    of the chip.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller</span><span class="p">:</span> <span class="n">GalilDMC4133Controller</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the arm class</span>

<span class="sd">        Args:</span>
<span class="sd">            controller: an instance of DMC4133Controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span>

        <span class="c1"># initialization (all these points will have values in quadrature</span>
        <span class="c1"># counts)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_left_bottom_position</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_left_top_position</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_right_top_position</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># motion directions (all these values are in quadrature counts)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># right_top - left_bottom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># left_top - left_bottom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># right_top - left_top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm_a</span><span class="p">:</span> <span class="nb">float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm_b</span><span class="p">:</span> <span class="nb">float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm_c</span><span class="p">:</span> <span class="nb">float</span>

        <span class="c1"># eqn of the chip plane (in quadrature counts)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>

        <span class="c1"># current vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># chip details</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span> <span class="nb">int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pads</span><span class="p">:</span> <span class="nb">int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_row_distance</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># in quadrature counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_pad_distance</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># in quadrature counts</span>

        <span class="c1"># arm kinematics (in the units of quadrature counts)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">:</span> <span class="nb">int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">:</span> <span class="nb">int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">:</span> <span class="nb">int</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_arm_pick_up_distance</span><span class="p">:</span> <span class="nb">int</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_pad</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">left_bottom_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left_bottom_position</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">left_top_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left_top_position</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">right_top_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right_top_position</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arm_pick_up_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arm_pick_up_distance</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">speed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">acceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span>

<div class="viewcode-block" id="GalilDMC4133Arm.set_arm_kinematics">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_arm_kinematics">[docs]</a>
    <span class="k">def</span> <span class="nf">set_arm_kinematics</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">acceleration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">deceleration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the arm kinematics values for speed, acceleration and</span>
<span class="sd">        deceleration in micro meters/sec and micro meters/sec^2 respectively</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">acceleration</span> <span class="o">%</span> <span class="mi">256</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">deceleration</span> <span class="o">%</span> <span class="mi">256</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Acceleration and deceleration must be a multiple of 256. &quot;</span>
                <span class="s2">&quot;Units are micro meters/sec^2&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_speed</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">acceleration</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">deceleration</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_pick_up_distance">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_pick_up_distance">[docs]</a>
    <span class="k">def</span> <span class="nf">set_pick_up_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets pick up distance in micrometers for the arm</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_arm_pick_up_distance</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_left_bottom_position">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_left_bottom_position">[docs]</a>
    <span class="k">def</span> <span class="nf">set_left_bottom_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_left_bottom_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_ortho_vector</span><span class="p">()</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_left_top_position">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_left_top_position">[docs]</a>
    <span class="k">def</span> <span class="nf">set_left_top_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_left_top_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_ortho_vector</span><span class="p">()</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_right_top_position">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_right_top_position">[docs]</a>
    <span class="k">def</span> <span class="nf">set_right_top_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_right_top_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_ortho_vector</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_calculate_ortho_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_left_bottom_position</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left_top_position</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right_top_position</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="k">return</span>

        <span class="n">right_top_position</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_right_top_position</span><span class="p">)</span>
        <span class="n">left_bottom_position</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_left_bottom_position</span>
        <span class="p">)</span>
        <span class="n">left_top_position</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_left_top_position</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">right_top_position</span> <span class="o">-</span> <span class="n">left_bottom_position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm_a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm_a</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">left_top_position</span> <span class="o">-</span> <span class="n">left_bottom_position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm_b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm_b</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">right_top_position</span> <span class="o">-</span> <span class="n">left_top_position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm_c</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm_c</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">)</span>
        <span class="n">norm_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">norm_n</span>

        <span class="n">intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left_bottom_position</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>

<div class="viewcode-block" id="GalilDMC4133Arm.move_motor_a_by">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_motor_a_by">[docs]</a>
    <span class="k">def</span> <span class="nf">move_motor_a_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves motor A by distance given in micro meters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_a</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

        <span class="n">a</span><span class="o">.</span><span class="n">relative_position</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">acceleration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">deceleration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">servo_here</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">wait_till_motor_motion_complete</span><span class="p">()</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.move_motor_b_by">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_motor_b_by">[docs]</a>
    <span class="k">def</span> <span class="nf">move_motor_b_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves motor B by distance given in micro meters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_b</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

        <span class="n">b</span><span class="o">.</span><span class="n">relative_position</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">acceleration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">deceleration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">servo_here</span><span class="p">()</span>
        <span class="n">b</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
        <span class="n">b</span><span class="o">.</span><span class="n">wait_till_motor_motion_complete</span><span class="p">()</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.move_motor_c_by">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_motor_c_by">[docs]</a>
    <span class="k">def</span> <span class="nf">move_motor_c_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves motor B by distance given in micro meters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_c</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">relative_position</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">acceleration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">deceleration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">servo_here</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">wait_till_motor_motion_complete</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_setup_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_vec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets up motion parameters. all arguments have units in quadrature counts</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>

        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">))</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]):</span>
                <span class="n">temp1</span> <span class="o">=</span> <span class="n">coord</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">temp2</span> <span class="o">=</span> <span class="n">coord</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp1</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">target2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp2</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp1</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">target2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp2</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">target2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">,</span> <span class="n">target1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="n">temp1</span>
                    <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">temp1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">temp1</span>
                    <span class="k">break</span>

                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">,</span> <span class="n">target2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="n">temp2</span>
                    <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">temp2</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">temp2</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot move to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">. Target location is &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;below chip plane.&quot;</span>
                <span class="p">)</span>

        <span class="n">sp_a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">speed</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">sp_a</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sp_a</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">sp_b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">speed</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">sp_b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sp_b</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">sp_c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">speed</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">sp_c</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sp_c</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">acc_a</span> <span class="o">=</span> <span class="n">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">)</span>
        <span class="n">acc_b</span> <span class="o">=</span> <span class="n">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">)</span>
        <span class="n">acc_c</span> <span class="o">=</span> <span class="n">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_acceleration</span><span class="p">)</span>

        <span class="n">dec_a</span> <span class="o">=</span> <span class="n">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">)</span>
        <span class="n">dec_b</span> <span class="o">=</span> <span class="n">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">)</span>
        <span class="n">dec_c</span> <span class="o">=</span> <span class="n">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">rel_vec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_deceleration</span><span class="p">)</span>

        <span class="n">motor_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_a</span>
        <span class="n">motor_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_b</span>
        <span class="n">motor_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_c</span>

        <span class="n">motor_a</span><span class="o">.</span><span class="n">relative_position</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">motor_a</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="n">sp_a</span><span class="p">)</span>
        <span class="n">motor_a</span><span class="o">.</span><span class="n">acceleration</span><span class="p">(</span><span class="n">acc_a</span><span class="p">)</span>
        <span class="n">motor_a</span><span class="o">.</span><span class="n">deceleration</span><span class="p">(</span><span class="n">dec_a</span><span class="p">)</span>
        <span class="n">motor_a</span><span class="o">.</span><span class="n">servo_here</span><span class="p">()</span>

        <span class="n">motor_b</span><span class="o">.</span><span class="n">relative_position</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">motor_b</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="n">sp_b</span><span class="p">)</span>
        <span class="n">motor_b</span><span class="o">.</span><span class="n">acceleration</span><span class="p">(</span><span class="n">acc_b</span><span class="p">)</span>
        <span class="n">motor_b</span><span class="o">.</span><span class="n">deceleration</span><span class="p">(</span><span class="n">dec_b</span><span class="p">)</span>
        <span class="n">motor_b</span><span class="o">.</span><span class="n">servo_here</span><span class="p">()</span>

        <span class="n">motor_c</span><span class="o">.</span><span class="n">relative_position</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">motor_c</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="n">sp_c</span><span class="p">)</span>
        <span class="n">motor_c</span><span class="o">.</span><span class="n">acceleration</span><span class="p">(</span><span class="n">acc_c</span><span class="p">)</span>
        <span class="n">motor_c</span><span class="o">.</span><span class="n">deceleration</span><span class="p">(</span><span class="n">dec_c</span><span class="p">)</span>
        <span class="n">motor_c</span><span class="o">.</span><span class="n">servo_here</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_move</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">begin_motors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">wait_till_motion_complete</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_pick_up</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">move_motor_c_by</span><span class="p">(</span><span class="n">distance</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span>
            <span class="n">rel_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_arm_pick_up_distance</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_put_down</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">motion_vec</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plane_eqn</span> <span class="o">*</span> <span class="n">current</span><span class="p">))</span> <span class="o">/</span> <span class="n">denominator</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span><span class="n">rel_vec</span><span class="o">=</span><span class="n">motion_vec</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>

<div class="viewcode-block" id="GalilDMC4133Arm.move_towards_left_bottom_position">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_towards_left_bottom_position">[docs]</a>
    <span class="k">def</span> <span class="nf">move_towards_left_bottom_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pick_up</span><span class="p">()</span>

        <span class="n">motion_vec</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span><span class="n">rel_vec</span><span class="o">=</span><span class="n">motion_vec</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">norm_a</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_put_down</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="o">=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.move_to_next_row">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_to_next_row">[docs]</a>
    <span class="k">def</span> <span class="nf">move_to_next_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Current position unknown.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot move further&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pick_up</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span>
            <span class="n">rel_vec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inter_row_distance</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_put_down</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="o">+</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.move_to_begin_row_pad_from_end_row_last_pad">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_to_begin_row_pad_from_end_row_last_pad">[docs]</a>
    <span class="k">def</span> <span class="nf">move_to_begin_row_pad_from_end_row_last_pad</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Current position unknown.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pads</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot move further&quot;</span><span class="p">)</span>

        <span class="n">motion_vec</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm_b</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inter_pad_distance</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">motion_vec</span><span class="p">))</span>
        <span class="n">motion_vec_cap</span> <span class="o">=</span> <span class="n">motion_vec</span> <span class="o">/</span> <span class="n">norm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pick_up</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span><span class="n">rel_vec</span><span class="o">=</span><span class="n">motion_vec_cap</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_put_down</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="o">+</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.move_to_row">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_to_row">[docs]</a>
    <span class="k">def</span> <span class="nf">move_to_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Row num: </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s2"> is out of range. Row numbers start from 1 &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and max number of rows is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inter_row_distance</span>

        <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You are at the row where you want to be. Current row number &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pick_up</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span><span class="n">rel_vec</span><span class="o">=</span><span class="n">sign</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_put_down</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_row</span> <span class="o">=</span> <span class="n">num</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.move_to_pad">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.move_to_pad">[docs]</a>
    <span class="k">def</span> <span class="nf">move_to_pad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pads</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Pad num: </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s2"> is out of range. Pad number start from 1 &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and max number is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pads</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inter_pad_distance</span>

        <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You are at the pad where you want to be. Current pad &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;number is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pick_up</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_motion</span><span class="p">(</span><span class="n">rel_vec</span><span class="o">=</span><span class="n">sign</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_move</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_put_down</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_pad</span> <span class="o">=</span> <span class="n">num</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_motor_a_forward_limit">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_motor_a_forward_limit">[docs]</a>
    <span class="k">def</span> <span class="nf">set_motor_a_forward_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_a</span><span class="o">.</span><span class="n">forward_sw_limit</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_motor_a_reverse_limit">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_motor_a_reverse_limit">[docs]</a>
    <span class="k">def</span> <span class="nf">set_motor_a_reverse_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_a</span><span class="o">.</span><span class="n">reverse_sw_limit</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_motor_b_forward_limit">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_motor_b_forward_limit">[docs]</a>
    <span class="k">def</span> <span class="nf">set_motor_b_forward_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_b</span><span class="o">.</span><span class="n">forward_sw_limit</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_motor_b_reverse_limit">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_motor_b_reverse_limit">[docs]</a>
    <span class="k">def</span> <span class="nf">set_motor_b_reverse_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_b</span><span class="o">.</span><span class="n">reverse_sw_limit</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_motor_c_forward_limit">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_motor_c_forward_limit">[docs]</a>
    <span class="k">def</span> <span class="nf">set_motor_c_forward_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_c</span><span class="o">.</span><span class="n">forward_sw_limit</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="GalilDMC4133Arm.set_motor_c_reverse_limit">
<a class="viewcode-back" href="../../../../drivers_api/Galil.html#qcodes.instrument_drivers.Galil.GalilDMC4133Arm.set_motor_c_reverse_limit">[docs]</a>
    <span class="k">def</span> <span class="nf">set_motor_c_reverse_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">absolute_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">motor_c</span><span class="o">.</span><span class="n">reverse_sw_limit</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span></div>
</div>



<span class="k">def</span> <span class="nf">_convert_micro_meter_to_quadrature_counts</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_calculate_vector_component</span><span class="p">(</span><span class="n">vec</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">return_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="o">*</span> <span class="n">val</span><span class="p">))</span>
    <span class="n">return_val</span> <span class="o">=</span> <span class="n">return_val</span> <span class="o">+</span> <span class="mi">1024</span>
    <span class="n">rem</span> <span class="o">=</span> <span class="n">return_val</span> <span class="o">%</span> <span class="mi">1024</span>
    <span class="n">return_val</span> <span class="o">=</span> <span class="n">return_val</span> <span class="o">-</span> <span class="n">rem</span>

    <span class="k">assert</span> <span class="n">return_val</span> <span class="o">%</span> <span class="mi">1024</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">return_val</span>


<span class="n">Arm</span> <span class="o">=</span> <span class="n">GalilDMC4133Arm</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Alias for backwards compatibility</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>