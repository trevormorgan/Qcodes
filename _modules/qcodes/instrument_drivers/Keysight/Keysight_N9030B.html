<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qcodes.instrument_drivers.Keysight.Keysight_N9030B &mdash; QCoDeS 0.27.0.dev9139 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=9e84aeb3"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            QCoDeS
          </a>
              <div class="version">
                0.27.0.dev9139+main.g009ec80fb
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/15_minutes_to_QCoDeS.html">15 minutes to QCoDeS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/index.html">Examples of using QCoDeS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/index.html">QCoDes API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../drivers_api/index.html">Instrument Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help.html">Get Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">QCoDeS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">qcodes.instrument_drivers.Keysight.Keysight_N9030B</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for qcodes.instrument_drivers.Keysight.Keysight_N9030B</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">qcodes.instrument</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">InstrumentBaseKWArgs</span><span class="p">,</span>
    <span class="n">InstrumentChannel</span><span class="p">,</span>
    <span class="n">VisaInstrument</span><span class="p">,</span>
    <span class="n">VisaInstrumentKWArgs</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">qcodes.parameters</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Parameter</span><span class="p">,</span>
    <span class="n">ParameterWithSetpoints</span><span class="p">,</span>
    <span class="n">ParamRawDataType</span><span class="p">,</span>
    <span class="n">create_on_off_val_mapping</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">qcodes.validators</span> <span class="kn">import</span> <span class="n">Arrays</span><span class="p">,</span> <span class="n">Bool</span><span class="p">,</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">Ints</span><span class="p">,</span> <span class="n">Numbers</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span>

    <span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Unpack</span>


<span class="k">class</span> <span class="nc">FrequencyAxis</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">,</span>
        <span class="n">stop</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">,</span>
        <span class="n">npts</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_npts</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">npts</span>

    <span class="k">def</span> <span class="nf">get_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParamRawDataType</span><span class="p">:</span>
        <span class="n">start_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">()</span>
        <span class="n">stop_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">()</span>
        <span class="n">npts_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_npts</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">start_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">stop_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">npts_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start_val</span><span class="p">,</span> <span class="n">stop_val</span><span class="p">,</span> <span class="n">npts_val</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Trace</span><span class="p">(</span><span class="n">ParameterWithSetpoints</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">get_data</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">ParamRawDataType</span><span class="p">],</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># the parameter classes should ideally be generic in instrument</span>
        <span class="c1"># and root instrument classes so we can specialize here.</span>
        <span class="c1"># for now we have to ignore a type error from pyright</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrument</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">KeysightN9030BSpectrumAnalyzerMode</span> <span class="o">|</span> <span class="n">KeysightN9030BPhaseNoiseMode</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="p">:</span> <span class="n">KeysightN9030B</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span> <span class="o">=</span> <span class="n">get_data</span>

    <span class="k">def</span> <span class="nf">get_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParamRawDataType</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>


<div class="viewcode-block" id="KeysightN9030BSpectrumAnalyzerMode">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BSpectrumAnalyzerMode">[docs]</a>
<span class="k">class</span> <span class="nc">KeysightN9030BSpectrumAnalyzerMode</span><span class="p">(</span><span class="n">InstrumentChannel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spectrum Analyzer Mode for Keysight N9030B instrument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">KeysightN9030B</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">additional_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">InstrumentBaseKWArgs</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_wait</span> <span class="o">=</span> <span class="n">additional_wait</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8e7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_max_freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;503&quot;</span><span class="p">:</span> <span class="mf">3.7e9</span><span class="p">,</span>
            <span class="s2">&quot;508&quot;</span><span class="p">:</span> <span class="mf">8.5e9</span><span class="p">,</span>
            <span class="s2">&quot;513&quot;</span><span class="p">:</span> <span class="mf">13.8e9</span><span class="p">,</span>
            <span class="s2">&quot;526&quot;</span><span class="p">:</span> <span class="mf">27e9</span><span class="p">,</span>
            <span class="s2">&quot;544&quot;</span><span class="p">:</span> <span class="mf">44.5e9</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">opt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">hw_opt_for_max_freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_max_freq</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hw_opt_for_max_freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">options</span><span class="p">():</span>
                <span class="n">opt</span> <span class="o">=</span> <span class="n">hw_opt_for_max_freq</span>
        <span class="k">assert</span> <span class="n">opt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_max_freq</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>

        <span class="c1"># Frequency Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:FREQuency:STARt?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_start</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Start Frequency&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start Frequency&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stop&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:FREQuency:STOP?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_stop</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Stop Frequency&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop Frequency&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:FREQuency:CENTer?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_center</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span> <span class="o">-</span> <span class="mi">5</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Sets and gets center frequency&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets and gets center frequency&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;span&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:FREQuency:SPAN?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_span</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Changes span of frequency&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes span of frequency&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;npts&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:POINts?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:POINts </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20001</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Number of points for the sweep&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of points for the sweep&quot;&quot;&quot;</span>

        <span class="c1"># Amplitude/Input Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mech_attenuation</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mech_attenuation&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;dB&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:POW:ATT?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:POW:ATT </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Internal mechanical attenuation&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal mechanical attenuation&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preamp</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;preamp&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:POW:GAIN:BAND?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:POW:GAIN:BAND </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="s2">&quot;LOW&quot;</span><span class="p">,</span> <span class="s2">&quot;FULL&quot;</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Preamplifier selection&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Preamplifier selection&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preamp_enabled</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;preamp_enabled&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:POW:GAIN:STAT?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:POW:GAIN:STAT </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="n">create_on_off_val_mapping</span><span class="p">(</span><span class="n">on_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">off_val</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Preamplifier state&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Preamplifier state&quot;&quot;&quot;</span>

        <span class="c1"># Resolution parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_bw</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;res_bw&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:BAND:RES?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:BAND:RES </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">8e6</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Resolution Bandwidth&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolution Bandwidth&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_bw</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;video_bw&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:BAND:VID?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:BAND:VID </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">50e6</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Video Filter Bandwidth&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Video Filter Bandwidth&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_bw_type</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;res_bw_type&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:BAND:TYPE?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:BAND:TYPE </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="s2">&quot;DB3&quot;</span><span class="p">,</span> <span class="s2">&quot;DB6&quot;</span><span class="p">,</span> <span class="s2">&quot;IMP&quot;</span><span class="p">,</span> <span class="s2">&quot;NOISE&quot;</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;The instrument provides four ways of specifying the &quot;</span>
                <span class="s2">&quot;bandwidth of a Gaussian filter:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 1. The -3 dB bandwidth of the filter (DB3)</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 2. The -6 dB bandwidth of the filter (DB6)</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 3. The equivalent Noise bandwidth of the filter, &quot;</span>
                <span class="s2">&quot;which is defined as the bandwidth of a rectangular &quot;</span>
                <span class="s2">&quot;filter with the same peak gain which would pass the &quot;</span>
                <span class="s2">&quot;same power for noise signals</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 4. The equivalent Impulse bandwidth of the filter, &quot;</span>
                <span class="s2">&quot;which is defined as the bandwidth of a rectangular &quot;</span>
                <span class="s2">&quot;filter with the same peak gain which would pass the &quot;</span>
                <span class="s2">&quot;same power for impulsive (narrow pulsed) signals.&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The instrument provides four ways of specifying the bandwidth</span>
<span class="sd">        of a Gaussian filter:</span>

<span class="sd">            1. The -3 dB bandwidth of the filter (DB3)</span>
<span class="sd">            2. The -6 dB bandwidth of the filter (DB6)</span>
<span class="sd">            3. The equivalent Noise bandwidth of the filter,</span>
<span class="sd">               which is defined as the bandwidth of a rectangular</span>
<span class="sd">               filter with the same peak gain which would pass the</span>
<span class="sd">               same power for noise signals</span>
<span class="sd">            4. The equivalent Impulse bandwidth of the filter,</span>
<span class="sd">               which is defined as the bandwidth of a rectangular filter</span>
<span class="sd">               with the same peak gain which would pass the same power</span>
<span class="sd">               for impulsive (narrow pulsed) signals.</span>
<span class="sd">            &quot;&quot;&quot;</span>

        <span class="c1"># Input parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detector</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;detector&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:DET:TRAC?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:DET:TRAC </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="s2">&quot;NORM&quot;</span><span class="p">,</span> <span class="s2">&quot;AVER&quot;</span><span class="p">,</span> <span class="s2">&quot;POS&quot;</span><span class="p">,</span> <span class="s2">&quot;SAMP&quot;</span><span class="p">,</span> <span class="s2">&quot;NEG&quot;</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Detector type&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detector type&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">average_type</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;average_type&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:AVER:TYPE?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENS:AVER:TYPE </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="s2">&quot;LOG&quot;</span><span class="p">,</span> <span class="s2">&quot;RMS&quot;</span><span class="p">,</span> <span class="s2">&quot;SCAL&quot;</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Lets you control the way averaging is done. The averaging processes &quot;</span>
                <span class="s2">&quot;affected are:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 1. Trace averaging</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 2. Average detector averages signals within the resolution BW</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 3. Noise marker is corrected for average type</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 4. VBW filtering (not affected if Average detector is used).</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;The averaging types are:&quot;</span>
                <span class="s2">&quot; 1. LOG: Selects the logarithmic (decibel) scale for all filtering and &quot;</span>
                <span class="s2">&quot;averaging processes. This scale is sometimes called &#39;Video&#39; because it &quot;</span>
                <span class="s2">&quot;is the most common display and analysis scale for the video signal &quot;</span>
                <span class="s2">&quot;within a spectrum instrument. This scale is excellent for finding CW &quot;</span>
                <span class="s2">&quot;signals near noise, but its response to noise-like signals is 2.506 dB &quot;</span>
                <span class="s2">&quot;lower than the average power of those noise signals. This is compensated &quot;</span>
                <span class="s2">&quot;for in the Marker Noise function.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 2. RMS: All filtering and averaging processes work on the power (the square &quot;</span>
                <span class="s2">&quot;of the magnitude) of the signal, instead of its log or envelope voltage. This &quot;</span>
                <span class="s2">&quot;scale is best for measuring the true time average power of complex signals. &quot;</span>
                <span class="s2">&quot;This scale is sometimes called RMS because the resulting voltage is proportional &quot;</span>
                <span class="s2">&quot;to the square root of the mean of the square of the voltage.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; 3. SCAL: (Voltage) All filtering and averaging processes work on the voltage &quot;</span>
                <span class="s2">&quot;of the envelope of the signal. This scale is good for observing rise and fall &quot;</span>
                <span class="s2">&quot;behavior of AM or pulse-modulated signals such as radar and TDMA transmitters, &quot;</span>
                <span class="s2">&quot;but its response to noise-like signals is 1.049 dB lower than the average power &quot;</span>
                <span class="s2">&quot;of those noise signals. This is compensated for in the Marker Noise function.&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lets you control the way averaging is done. The averaging</span>
<span class="sd">        processes affected are:</span>

<span class="sd">        1. Trace averaging</span>
<span class="sd">        2. Average detector averages signals within the resolution BW</span>
<span class="sd">        3. Noise marker is corrected for average type</span>
<span class="sd">        4. VBW filtering (not affected if Average detector is used).</span>

<span class="sd">        The averaging types are:</span>

<span class="sd">        1. LOG: Selects the logarithmic (decibel) scale for all filtering</span>
<span class="sd">           and averaging processes. This scale is sometimes called</span>
<span class="sd">           &#39;Video&#39; because it is the most common display and analysis</span>
<span class="sd">           scale for the video signal within a spectrum instrument.</span>
<span class="sd">           This scale is excellent for finding CW signals near noise,</span>
<span class="sd">           but its response to noise-like signals is 2.506 dB lower</span>
<span class="sd">           than the average power of those noise signals.</span>
<span class="sd">           This is compensated for in the Marker Noise function.</span>
<span class="sd">        2. RMS: All filtering and averaging processes work on the power</span>
<span class="sd">           (the square of the magnitude) of the signal, instead of its</span>
<span class="sd">           log or envelope voltage. This scale is best for measuring</span>
<span class="sd">           the true time average power of complex signals. This scale</span>
<span class="sd">           is sometimes called RMS because the resulting voltage is</span>
<span class="sd">           proportional to the square root of the mean of the square</span>
<span class="sd">           of the voltage.</span>
<span class="sd">        3. SCAL: (Voltage) All filtering and averaging processes</span>
<span class="sd">           work on the voltage of the envelope of the signal.</span>
<span class="sd">           This scale is good for observing rise and fall behavior</span>
<span class="sd">           of AM or pulse-modulated signals such as radar and TDMA transmitters,</span>
<span class="sd">           but its response to noise-like signals is 1.049 dB lower than</span>
<span class="sd">           the average power of those noise signals. This is compensated</span>
<span class="sd">           for in the Marker Noise function.&quot;&quot;&quot;</span>

        <span class="c1"># Sweep Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sweep_time</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sweep_time&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sweep time&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TIME?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TIME </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;gets sweep time&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;gets sweep time&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_sweep_time_enabled</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;auto_sweep_time_enabled&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TIME:AUTO?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TIME:AUTO </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="n">create_on_off_val_mapping</span><span class="p">(</span><span class="n">on_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">off_val</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;enables auto sweep time&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;enables auto sweep time&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_sweep_type_enabled</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;auto_sweep_type_enabled&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TYPE:AUTO?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TYPE:AUTO </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="n">create_on_off_val_mapping</span><span class="p">(</span><span class="n">on_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">off_val</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;enables auto sweep type&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;enables auto sweep type&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sweep_type</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sweep_type&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TYPE?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:SWEep:TYPE </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;fft&quot;</span><span class="p">:</span> <span class="s2">&quot;FFT&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sweep&quot;</span><span class="p">:</span> <span class="s2">&quot;SWE&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Sets up sweep type. Possible options are &#39;fft&#39; and &#39;sweep&#39;.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets up sweep type. Possible options are &#39;fft&#39; and &#39;sweep&#39;.&quot;&quot;&quot;</span>

        <span class="c1"># Array (Data) Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq_axis</span><span class="p">:</span> <span class="n">FrequencyAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;freq_axis&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span>
            <span class="n">npts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Arrays</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="o">.</span><span class="n">get_latest</span><span class="p">,)),</span>
            <span class="n">parameter_class</span><span class="o">=</span><span class="n">FrequencyAxis</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Creates frequency axis for the sweep from start, &quot;</span>
            <span class="s2">&quot;stop and npts values.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates frequency axis for the sweep from start, stop and npts values.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">:</span> <span class="n">Trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trace&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;dB&quot;</span><span class="p">,</span>
            <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Arrays</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="o">.</span><span class="n">get_latest</span><span class="p">,)),</span>
            <span class="n">setpoints</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_axis</span><span class="p">,),</span>
            <span class="n">get_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_data</span><span class="p">,</span>
            <span class="n">parameter_class</span><span class="o">=</span><span class="n">Trace</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Gets trace data.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets trace data.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets start frequency</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:SENSe:FREQuency:STARt </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_trace</span><span class="p">()</span>

        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start frequency rounded to </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets stop frequency</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:SENSe:FREQuency:STOP </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_trace</span><span class="p">()</span>

        <span class="n">stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">stop</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stop frequency rounded to </span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets center frequency and updates start and stop frequencies if they</span>
<span class="sd">        change.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:SENSe:FREQuency:CENTer </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_trace</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets frequency span and updates start and stop frequencies if they</span>
<span class="sd">        change.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:SENSe:FREQuency:SPAN </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_trace</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParamRawDataType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets data from the measurement.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root_instr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span>
        <span class="c1"># Check if we should run a new sweep</span>
        <span class="n">auto_sweep</span> <span class="o">=</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">auto_sweep</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">auto_sweep</span><span class="p">:</span>
            <span class="c1"># If we need to run a sweep, we need to set the timeout to take into account</span>
            <span class="c1"># the sweep time</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweep_time</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_wait</span>
            <span class="k">with</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">set_to</span><span class="p">(</span><span class="n">timeout</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">visa_handle</span><span class="o">.</span><span class="n">query_binary_values</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;:READ:</span><span class="si">{</span><span class="n">root_instr</span><span class="o">.</span><span class="n">measurement</span><span class="p">()</span><span class="si">}{</span><span class="n">trace_num</span><span class="si">}</span><span class="s2">?&quot;</span><span class="p">,</span>
                    <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
                    <span class="n">is_big_endian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">visa_handle</span><span class="o">.</span><span class="n">query_binary_values</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;:FETC:</span><span class="si">{</span><span class="n">root_instr</span><span class="o">.</span><span class="n">measurement</span><span class="p">()</span><span class="si">}{</span><span class="n">trace_num</span><span class="si">}</span><span class="s2">?&quot;</span><span class="p">,</span>
                <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
                <span class="n">is_big_endian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<div class="viewcode-block" id="KeysightN9030BSpectrumAnalyzerMode.update_trace">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BSpectrumAnalyzerMode.update_trace">[docs]</a>
    <span class="k">def</span> <span class="nf">update_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates all frequency parameters together when one is changed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span></div>


<div class="viewcode-block" id="KeysightN9030BSpectrumAnalyzerMode.setup_swept_sa_sweep">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BSpectrumAnalyzerMode.setup_swept_sa_sweep">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_swept_sa_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">npts</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets up the Swept SA measurement sweep for Spectrum Analyzer Mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;SA&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;SAN&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">available_meas</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">measurement</span><span class="p">(</span><span class="s2">&quot;SAN&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Swept SA measurement is not available on your &quot;</span>
                <span class="s2">&quot;Keysight N9030B instrument with Spectrum &quot;</span>
                <span class="s2">&quot;Analyzer mode.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span></div>


<div class="viewcode-block" id="KeysightN9030BSpectrumAnalyzerMode.autotune">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BSpectrumAnalyzerMode.autotune">[docs]</a>
    <span class="k">def</span> <span class="nf">autotune</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Autotune quickly get to the most likely signal of interest, and</span>
<span class="sd">        position it optimally on the display.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;:SENS:FREQuency:TUNE:IMMediate&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="KeysightN9030BPhaseNoiseMode">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BPhaseNoiseMode">[docs]</a>
<span class="k">class</span> <span class="nc">KeysightN9030BPhaseNoiseMode</span><span class="p">(</span><span class="n">InstrumentChannel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Phase Noise Mode for Keysight N9030B instrument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">KeysightN9030B</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">InstrumentBaseKWArgs</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valid_max_freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;503&quot;</span><span class="p">:</span> <span class="mi">3699999995</span><span class="p">,</span>
            <span class="s2">&quot;508&quot;</span><span class="p">:</span> <span class="mi">8499999995</span><span class="p">,</span>
            <span class="s2">&quot;513&quot;</span><span class="p">:</span> <span class="mi">13799999995</span><span class="p">,</span>
            <span class="s2">&quot;526&quot;</span><span class="p">:</span> <span class="mi">26999999995</span><span class="p">,</span>
            <span class="s2">&quot;544&quot;</span><span class="p">:</span> <span class="mi">44499999995</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">opt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">hw_opt_for_max_freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_max_freq</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hw_opt_for_max_freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">options</span><span class="p">():</span>
                <span class="n">opt</span> <span class="o">=</span> <span class="n">hw_opt_for_max_freq</span>
        <span class="k">assert</span> <span class="n">opt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_max_freq</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;npts&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:LPLot:SWEep:POINts?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:LPLot:SWEep:POINts </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Ints</span><span class="p">(</span><span class="mi">601</span><span class="p">,</span> <span class="mi">20001</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Number of points for the sweep&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of points for the sweep&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;start_offset&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:LPLot:FREQuency:OFFSet:STARt?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_start_offset</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;start frequency offset for the plot&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;start frequency offset for the plot&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stop_offset&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:LPLot:FREQuency:OFFSet:STOP?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_stop_offset</span><span class="p">,</span>
            <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span> <span class="o">+</span> <span class="mi">99</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;stop frequency offset for the plot&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;stop frequency offset for the plot&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">signal_tracking_enabled</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;signal_tracking_enabled&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:FREQuency:CARRier:TRACk?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:SENSe:FREQuency:CARRier:TRACk </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="n">create_on_off_val_mapping</span><span class="p">(</span><span class="n">on_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">off_val</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Gets/Sets signal tracking. When signal tracking is &quot;</span>
            <span class="s2">&quot;enabled carrier signal is repeatedly realigned. Signal &quot;</span>
            <span class="s2">&quot;Tracking assumes the new acquisition occurs repeatedly &quot;</span>
            <span class="s2">&quot;without pause.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets/Sets signal tracking.</span>
<span class="sd">        When signal tracking is enabled carrier signal is repeatedly</span>
<span class="sd">        realigned. Signal Tracking assumes the new acquisition occurs</span>
<span class="sd">        repeatedly without pause.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">freq_axis</span><span class="p">:</span> <span class="n">FrequencyAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;freq_axis&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;Hz&quot;</span><span class="p">,</span>
            <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span>
            <span class="n">npts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Arrays</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="o">.</span><span class="n">get_latest</span><span class="p">,)),</span>
            <span class="n">parameter_class</span><span class="o">=</span><span class="n">FrequencyAxis</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Creates frequency axis for the sweep from &quot;</span>
            <span class="s2">&quot;start_offset, stop_offset and npts values.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates frequency axis for the sweep from start_offset,</span>
<span class="sd">        stop_offset and npts values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">:</span> <span class="n">Trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trace&quot;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;dB&quot;</span><span class="p">,</span>
            <span class="n">number</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Arrays</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="o">.</span><span class="n">get_latest</span><span class="p">,)),</span>
            <span class="n">setpoints</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_axis</span><span class="p">,),</span>
            <span class="n">get_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_data</span><span class="p">,</span>
            <span class="n">parameter_class</span><span class="o">=</span><span class="n">Trace</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Gets trace data&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets trace data&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_start_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets start offset for frequency in the plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:SENSe:LPLot:FREQuency:OFFSet:STARt </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">start_offset</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not set start offset to </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> setting it to </span><span class="si">{</span><span class="n">start_offset</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="n">stop_offset</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">stop_offset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Provided start frequency offset </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> Hz was &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;greater than preset stop frequency offset &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stop_offset</span><span class="si">}</span><span class="s2"> Hz. Provided start frequency &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;offset </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> Hz is set and new stop freq offset&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; is: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">()</span><span class="si">}</span><span class="s2"> Hz.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_stop_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets stop offset for frequency in the plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:SENSe:LPLot:FREQuency:OFFSet:STOP </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">stop_offset</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not set stop offset to </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> setting it to </span><span class="si">{</span><span class="n">stop_offset</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">start_offset</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">start_offset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Provided stop frequency offset </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> Hz was &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;less than preset start frequency offset &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_offset</span><span class="si">}</span><span class="s2"> Hz. Provided stop frequency &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;offset </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> Hz is set and new start freq offset&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; is: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">()</span><span class="si">}</span><span class="s2"> Hz.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParamRawDataType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets data from the measurement.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root_instr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span>
        <span class="n">measurement</span> <span class="o">=</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">measurement</span><span class="p">()</span>
        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">visa_handle</span><span class="o">.</span><span class="n">query_binary_values</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;:READ:</span><span class="si">{</span><span class="n">measurement</span><span class="si">}</span><span class="s2">1?&quot;</span><span class="p">,</span>
            <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="n">is_big_endian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">trace_res_details</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace_res_details</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">7</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">trace_res_details</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">trace_res_details</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Carrier(s) Incorrect or Missing!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">())</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">root_instr</span><span class="o">.</span><span class="n">visa_handle</span><span class="o">.</span><span class="n">query_binary_values</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;:READ:</span><span class="si">{</span><span class="n">measurement</span><span class="si">}{</span><span class="n">trace_num</span><span class="si">}</span><span class="s2">?&quot;</span><span class="p">,</span>
                <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
                <span class="n">is_big_endian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t receive any data. Command timed out.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">return</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<div class="viewcode-block" id="KeysightN9030BPhaseNoiseMode.setup_log_plot_sweep">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BPhaseNoiseMode.setup_log_plot_sweep">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_log_plot_sweep</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">npts</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets up the Log Plot measurement sweep for Phase Noise Mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;PNOISE&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;LPL&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">available_meas</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root_instrument</span><span class="o">.</span><span class="n">measurement</span><span class="p">(</span><span class="s2">&quot;LPL&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Log Plot measurement is not available on your &quot;</span>
                <span class="s2">&quot;Keysight N9030B instrument with Phase Noise &quot;</span>
                <span class="s2">&quot;mode.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">(</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span></div>


<div class="viewcode-block" id="KeysightN9030BPhaseNoiseMode.autotune">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030BPhaseNoiseMode.autotune">[docs]</a>
    <span class="k">def</span> <span class="nf">autotune</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On autotune, the measurement automatically searches for and tunes to</span>
<span class="sd">        the strongest signal in the full span of the analyzer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;:SENSe:FREQuency:CARRier:SEARch&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="KeysightN9030B">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030B">[docs]</a>
<span class="k">class</span> <span class="nc">KeysightN9030B</span><span class="p">(</span><span class="n">VisaInstrument</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Driver for Keysight N9030B PXA signal analyzer. Keysight N9030B PXA</span>
<span class="sd">    signal analyzer is part of Keysight X-Series Multi-touch Signal</span>
<span class="sd">    Analyzers.</span>
<span class="sd">    This driver allows Swept SA measurements in Spectrum Analyzer mode and</span>
<span class="sd">    Log Plot measurements in Phase Noise mode of the instrument.</span>

<span class="sd">    Args:</span>
<span class="sd">        name</span>
<span class="sd">        address</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">default_terminator</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">VisaInstrumentKWArgs</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_min_freq</span><span class="p">:</span> <span class="nb">float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_freq</span><span class="p">:</span> <span class="nb">float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_wait</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:INSTrument:SELect?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:INSTrument:SELect </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">available_modes</span><span class="p">()),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Allows setting of different modes present and licensed &quot;</span>
            <span class="s2">&quot;for the instrument.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows setting of different modes present and licensed</span>
<span class="sd">        for the instrument.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measurement</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;measurement&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:CONFigure?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:CONFigure:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="s2">&quot;SAN&quot;</span><span class="p">,</span> <span class="s2">&quot;LPL&quot;</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Sets measurement type from among the available &quot;</span>
            <span class="s2">&quot;measurement types.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets measurement type from among the available measurement types.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cont_meas</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cont_meas&quot;</span><span class="p">,</span>
            <span class="n">initial_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="s2">&quot;:INITiate:CONTinuous?&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="s2">&quot;:INITiate:CONTinuous </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">val_mapping</span><span class="o">=</span><span class="n">create_on_off_val_mapping</span><span class="p">(</span><span class="n">on_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">off_val</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Enables or disables continuous measurement.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enables or disables continuous measurement.&quot;&quot;&quot;</span>

        <span class="c1"># Set auto_sweep parameter</span>
        <span class="c1"># If we want to return multiple traces per setpoint without sweeping</span>
        <span class="c1"># multiple times, or return data on screen, then we can set this value false</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_sweep</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="s2">&quot;auto_sweep&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Auto Sweep&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">vals</span><span class="o">=</span><span class="n">Bool</span><span class="p">(),</span>
            <span class="n">initial_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parameter auto_sweep&quot;&quot;&quot;</span>

        <span class="c1"># Set binary format and don&#39;t allow change. There isn&#39;t much point to</span>
        <span class="c1"># allow this value to be varied. Retained for backwards compatibility.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;format&quot;</span><span class="p">,</span>
            <span class="n">get_cmd</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;real64&quot;</span><span class="p">,</span>
            <span class="n">set_cmd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">docstring</span><span class="o">=</span><span class="s2">&quot;Sets up format of data received&quot;</span><span class="p">,</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets up format of data received&quot;&quot;&quot;</span>
        <span class="c1"># Set default format on initialisation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FORM REAL,64&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FORM:BORD SWAP&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;SA&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_modes</span><span class="p">():</span>
            <span class="n">sa_mode</span> <span class="o">=</span> <span class="n">KeysightN9030BSpectrumAnalyzerMode</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sa&quot;</span><span class="p">,</span> <span class="n">additional_wait</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_additional_wait</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;sa&quot;</span><span class="p">,</span> <span class="n">sa_mode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Spectrum Analyzer mode is not available on this instrument.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;PNOISE&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_modes</span><span class="p">():</span>
            <span class="n">pnoise_mode</span> <span class="o">=</span> <span class="n">KeysightN9030BPhaseNoiseMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pn&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="s2">&quot;pn&quot;</span><span class="p">,</span> <span class="n">pnoise_mode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase Noise mode is not available on this instrument.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_message</span><span class="p">()</span>

<div class="viewcode-block" id="KeysightN9030B.available_modes">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030B.available_modes">[docs]</a>
    <span class="k">def</span> <span class="nf">available_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns present and licensed modes for the instrument.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">available_modes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;:INSTrument:CATalog?&quot;</span><span class="p">)</span>
        <span class="n">av_modes</span> <span class="o">=</span> <span class="n">available_modes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">modes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">av_modes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">modes</span> <span class="o">=</span> <span class="n">modes</span> <span class="o">+</span> <span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">modes</span> <span class="o">=</span> <span class="n">modes</span> <span class="o">+</span> <span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],)</span>
        <span class="k">return</span> <span class="n">modes</span></div>


<div class="viewcode-block" id="KeysightN9030B.available_meas">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030B.available_meas">[docs]</a>
    <span class="k">def</span> <span class="nf">available_meas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gives available measurement with a given mode for the instrument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">available_meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;:CONFigure:CATalog?&quot;</span><span class="p">)</span>
        <span class="n">av_meas</span> <span class="o">=</span> <span class="n">available_meas</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">measurements</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">meas</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">av_meas</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span> <span class="o">+</span> <span class="p">(</span><span class="n">meas</span><span class="p">,)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span> <span class="o">+</span> <span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="mi">1</span><span class="p">:],)</span>
        <span class="k">return</span> <span class="n">measurements</span></div>


<div class="viewcode-block" id="KeysightN9030B.options">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030B.options">[docs]</a>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns installed options numbers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;*OPT?&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">options_raw</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span></div>


<div class="viewcode-block" id="KeysightN9030B.reset">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030B.reset">[docs]</a>
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset the instrument by sending the RST command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*RST&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="KeysightN9030B.abort">
<a class="viewcode-back" href="../../../../drivers_api/Keysight.html#qcodes.instrument_drivers.Keysight.KeysightN9030B.abort">[docs]</a>
    <span class="k">def</span> <span class="nf">abort</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aborts the measurement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;:ABORt&quot;</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>