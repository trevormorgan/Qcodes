<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/png" sizes="310x346" href="../../_static/qcodes_favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Qcodes example with Keysight B1500 Semiconductor Parameter Analyzer &mdash; QCoDeS 0.27.0.dev9139 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=9e84aeb3"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="QCoDeS Example with Keysight B2200 Series Femto Leakage Switch Matrix" href="Qcodes%20example%20with%20Keysight%20B2200%20Series%20Femto%20Leakage%20Switch%20Matrix.html" />
    <link rel="prev" title="QCoDeS Example with Keysight 34980A Multifunction Switch / Measure Mainframe and Modules" href="Qcodes%20example%20with%20Keysight%2034980A%20Switch%20Mainframe%20and%20Modules.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            QCoDeS
          </a>
              <div class="version">
                0.27.0.dev9139+main.g009ec80fb
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../15_minutes_to_QCoDeS.html">15 minutes to QCoDeS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples of using QCoDeS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-examples">Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#dataset">DataSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotting">Plotting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#drivers">Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20Example%20with%20Keysight%20E4980A%20LCR%20meter.html">QCoDeS Example with Keysight E4980A LCR meter</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20Example%20with%20Yokogawa%20GS200%20and%20Keithley%207510.html">QCoDeS Example with Yokogawa GS200 and Keithley 7510 Multimeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20Aim%20TTi%20PL601-P.html">QCoDeS example with Aim TTi PL601-P</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20DelegateInstrument.html">Qcodes example with DelegateInstrument driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20Galil%20DMC4133%20Controller.html">QCoDeS example with Galil DMC4133 Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20InstrumentGroup%20and%20DelegateInstrument.html">Qcodes example with InstrumentGroup driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20Keithley%203706A%20System%20Switch.html">QCoDeS example with Keithley 3706A System Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes%20example%20with%20Keithley%20S46.html">QCoDeS Example with Tektronix Keithley S46</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes%20example%20with%20Rigol%20DG1062.html">QCoDeS Example with the Rigol DG 1062 Instrument</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes%20example%20with%20Tektronix%20DPO%2072004C.html">QCoDeS example with Textronix DPO 7200xx scopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20AMI430.html">QCoDeS Example with AMI430</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Agilent%2034400A.html">QCoDeS Example with Agilent 34400A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Alazar%20ATS9360.html">QCoDeS Example with Alazar ATS 9360</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Basel%20SP983c%20Preamp.html">Qcodes example with Basel SP983c Preamp and its Remote SP983a</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Cryomagnetics4G.html">Cryomagnetics 4G QCoDeS Driver Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20DynaCool%20PPMS.html">QCoDeS Example with DynaCool PPMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20HP8753D.html">QCoDeS Example with HP8753D</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Ithaco.html">QCoDeS Example with Itacho</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keithley%202600.html">QCoDeS Example with with Keithley 2600 series</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keithley%207510.html">QCoDeS Example with Tektronix Keithley 7510 Multimeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%2033500B.html">QCoDeS Example with Keysight 33500B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20344xxA.html">QCoDeS Example with Keysight 344xxA</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%2034980A%20Switch%20Mainframe%20and%20Modules.html">QCoDeS Example with Keysight 34980A Multifunction Switch / Measure Mainframe and Modules</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Qcodes example with Keysight B1500 Semiconductor Parameter Analyzer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Instrument-Short-info">Instrument Short info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Qcodes-driver-info">Qcodes driver info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Programming-Examples">Programming Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#High-Level-Interface">High Level Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Error-Message">Error Message</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Low-Level-Interface">Low Level Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20B2200%20Series%20Femto%20Leakage%20Switch%20Matrix.html">QCoDeS Example with Keysight B2200 Series Femto Leakage Switch Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20Infiniium%20Oscilloscope.html">QCoDeS Example with Keysight Infiniium Oscilloscopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20N9030B.html">Qcodes example with Keysight N9030B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20Network%20Analyzer.html">QCoDeS Example with Keysight Network Analyzers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Lakeshore%20325.html">QCoDeS Example with Lakeshore 325</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Lakeshore%20336%20or%20372%20-%20Bluefors%20T%20control.html">QCoDeS Example with the Lakeshore Model 372 to Control the Temperature of the Bluefors Fridge</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Minicircuits%20Switch%20boxes%20%28USB-XSPDT%29.html">QCoDeS Example with Minicircuits Switch Boxes Controlled via USB</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Oxford%20Mercury%20iPS.html">QCoDeS Example with Mercury iPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Oxford%20Triton.html">QCoDeS Example with Oxford Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20QDev_QDac.html">QCoDeS Example with QDac_channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rigol%20DP832.html">QCoDeS Example with Rigol DP832 Power Supply</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rigol%20DS1074Z.html">QCoDeS Example with the Rigol DS 1074 Z oscilloscope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rohde%20Schwarz%20RTO%201000%20series%20Oscilloscope.html">QCoDeS Example with Rohde Schwarz RTO 1000 Series Oscilloscope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rohde%20Schwarz%20SGS100A.html">QCoDeS Example with Rohde Schwarz SGS100A RF source</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rohde%20Schwarz%20ZNB.html">QCoDeS Example with Rohde Schwarz ZNB20/8</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Stahl.html">QCoDeS Example with the Stahl Bias Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Stanford%20SR830.html">QCoDeS Example with Stanford SR830</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Stanford%20SR86x%20with%20buffered%20readout.html">QCoDeS Example with Standford Research SR86x Lock-in Amplifier with Buffered Readout</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Tektronix%20AWG5014C.html">QCoDeS Example with Tektronix AWG5014</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Tektronix%20AWG70002A.html">QCoDeS Example with Tektronix AWG70002A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Tektronix%20TPS2012.html">QCoDeS Example with Tektronix TPS2012</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Yokogawa%20GS2xx.html">QCoDeS Example with Yokogawa GS200/GS210</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20keithley%202450.html">QCoDeS Example with Tektronix Keithley 2450 Source Meter</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%2Bbroadbean%20example%20with%20Tektronix%20AWG5208.html">QCoDeS+Broadbean Example with Tektronix AWG5208</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes-example-with-Signal-Hound-USB-SA124B.html">QCoDeS Example with Signal Hound USB-SA124B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes-example-with-Signal-Hound-USB-SA124B-ParameterWithSetpoints.html">QCoDeS Example with Signal Hound USB-SA124B ParameterWithSetpoints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#writing-drivers">Writing Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#logging">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">QCoDes API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers_api/index.html">Instrument Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Get Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QCoDeS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Examples of using QCoDeS</a></li>
      <li class="breadcrumb-item active">Qcodes example with Keysight B1500 Semiconductor Parameter Analyzer</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/driver_examples/Qcodes example with Keysight B1500 Parameter Analyzer.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
  <p>This page was generated from
    <a class="reference external"
    href="https://github.com/qcodes/qcodes/blob/main/docs/examples/driver_examples/Qcodes example with Keysight B1500 Parameter Analyzer.ipynb">docs/examples/driver_examples/Qcodes example with Keysight B1500 Parameter Analyzer.ipynb</a>.
    Interactive online version:
    <a href="https://mybinder.org/v2/gh/qcodes/qcodes/main?filepath=docs/examples/driver_examples/Qcodes example with Keysight B1500 Parameter Analyzer.ipynb"><img
alt="Binder badge"
    src="https://mybinder.org/badge_logo.svg"
    style="vertical-align:text-bottom"></a>.
  </p>
  <script>
    if (document.location.host) {
      var p = document.currentScript.previousSibling.previousSibling;
      var a = document.createElement('a');
      a.innerHTML = 'View in <em>nbviewer</em>';
      a.href = `https://nbviewer.jupyter.org/url${
        (window.location.protocol == 'https:' ? 's/' : '/') +
        window.location.host +
        window.location.pathname.slice(0, -4) }ipynb`;
      a.classList.add('reference');
      a.classList.add('external');
      p.appendChild(a);
      p.appendChild(document.createTextNode('.'));
    }
  </script>
</div><h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1  Qcodes example with Keysight B1500 Semiconductor Parameter Analyzer</p>
<ul class="toc-item"><li><p>1.1  Instrument Short info</p>
<ul class="toc-item"><li><p>1.1.1  Physical grouping</p>
</li><li><p>1.1.2  Logical grouping</p>
</li></ul></li><li><p>1.2  Qcodes driver info</p>
<ul class="toc-item"><li><p>1.2.1  Integer Flags and Constants used in the driver</p>
</li><li><p>1.2.2  High level interface</p>
</li><li><p>1.2.3  Low level interface</p>
</li></ul></li><li><p>1.3  Programming Examples</p>
<ul class="toc-item"><li><p>1.3.1  Initializing the instrument</p>
</li></ul></li><li><p>1.4  High Level Interface</p>
<ul class="toc-item"><li><p>1.4.1  Identifying and selecting installed modules</p>
</li><li><p>1.4.2  Enabling / Disabling channels</p>
</li><li><p>1.4.3  Perform self calibration</p>
</li><li><p>1.4.4  Performing sampling measurements</p>
</li><li><p>1.4.5  CV Sweep</p>
</li><li><p>1.4.6  IV Sweep</p>
</li><li><p>1.4.7  Performing phase compensation</p>
</li><li><p>1.4.8  Performing Open/Short/Load correction</p>
<ul class="toc-item"><li><p>1.4.8.1  Set and get reference values</p>
</li><li><p>1.4.8.2  Add CMU output frequency to the list for correction</p>
</li><li><p>1.4.8.3  Clear CMU output frequency list</p>
</li><li><p>1.4.8.4  Query CMU output frequency list</p>
</li><li><p>1.4.8.5  Open/Short/Load Correction</p>
</li></ul></li><li><p>1.4.9  SMU sourcing and measuring</p>
</li><li><p>1.4.10  Setting up ADCs to NPLC mode</p>
</li></ul></li><li><p>1.5  Error Message</p>
</li><li><p>1.6  Low Level Interface</p>
</li></ul></li></ul></div><section id="Qcodes-example-with-Keysight-B1500-Semiconductor-Parameter-Analyzer">
<h1>Qcodes example with Keysight B1500 Semiconductor Parameter Analyzer<a class="headerlink" href="#Qcodes-example-with-Keysight-B1500-Semiconductor-Parameter-Analyzer" title="Link to this heading"></a></h1>
<section id="Instrument-Short-info">
<h2>Instrument Short info<a class="headerlink" href="#Instrument-Short-info" title="Link to this heading"></a></h2>
<p>Here a short introduction on how the B1500 measurement system is composed is given. For a detailed overview it is strongly recommended to refer to the <em>B1500 Programming Guide</em> and also the <em>Parametric Measurement Handbook</em> by Keysight.</p>
<section id="Physical-grouping">
<h3>Physical grouping<a class="headerlink" href="#Physical-grouping" title="Link to this heading"></a></h3>
<p>The Keysight B1500 Semiconductor Parameter Analyzer consists of a <em>Mainframe</em> and can be equipped with various instrument <em>Modules</em>. 10 <em>Slots</em> are available in which up to 10 <em>modules</em> can be installed (some <em>modules</em> occupy two <em>slots</em>). Each <em>module</em> can have one or two <em>channels</em>.</p>
</section>
<section id="Logical-grouping">
<h3>Logical grouping<a class="headerlink" href="#Logical-grouping" title="Link to this heading"></a></h3>
<p>The measurements are typically done in one of the 20 measurement modes. The modes can be roughly subdivided into - Spot measurements - <strong>High Speed Spot Measurements</strong> - Pulsed Spot measurement - Sweep Measurements - Search Measurements</p>
<p>The <strong>High Speed Spot (HSS)</strong> Mode is essentually just a fancy way of saying to take readings and forcing constant voltages/currents. The <em>HSS</em> commands work at any time, independent of the currenttly selected Measurment Mode.</p>
<p>With the exception of the <em>High Speed Spot Measurement Mode</em>, the other modes have to be activated and configured by the user.</p>
</section>
</section>
<section id="Qcodes-driver-info">
<h2>Qcodes driver info<a class="headerlink" href="#Qcodes-driver-info" title="Link to this heading"></a></h2>
<p>As can be seen already from the instrument short info, the instrument is very versatile, but also very complex. Hence the driver will eventually consist of two layers: - The Low Level interface allows one to utilize all functions of the driver by offering a thin wrapper around the FLEX command set that the B1500 understands. - A Higher Level interface that provides a convenient access to the more frequently used features. Not all features are available via the high level interface.</p>
<p>The two driver levels can be used at the same time, so even if some functionality is not yet implemented in the high-level interface, the user can send a corresponding low-level command.</p>
<section id="Integer-Flags-and-Constants-used-in-the-driver">
<h3>Integer Flags and Constants used in the driver<a class="headerlink" href="#Integer-Flags-and-Constants-used-in-the-driver" title="Link to this heading"></a></h3>
<p>Both the high-level and the low-level interface use integer constants in many commands. For user convienience, the <code class="docutils literal notranslate"><span class="pre">qcodes.instrument_drivers.Keysight.keysightb1500.constants</span></code> provides more descriptive Python Enums for these constants. Although bare integer values can still be used, it is highly recommended to use the enumerations in order to avoid mistakes.</p>
</section>
<section id="High-level-interface">
<h3>High level interface<a class="headerlink" href="#High-level-interface" title="Link to this heading"></a></h3>
<p>The high level exposes instrument functionality via QCodes Parameters and Python methods on the mainframe object and the individual instrument module objects. For example, <em>High Speed Spot</em> Measurement commands for forcing constant voltages/currents or for taking simple readings are implemented.</p>
</section>
<section id="Low-level-interface">
<h3>Low level interface<a class="headerlink" href="#Low-level-interface" title="Link to this heading"></a></h3>
<p>The Low Level interface (<code class="docutils literal notranslate"><span class="pre">MessageBuilder</span></code> class) provides a wrapper function for each FLEX command. From the low-level, the full functionality of the instrument can be controlled.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">MessageBuilder</span></code> assembles a message string which later can be sent to the instrument using the low level <code class="docutils literal notranslate"><span class="pre">write</span></code> and <code class="docutils literal notranslate"><span class="pre">ask</span></code> methods. One can also use the <code class="docutils literal notranslate"><span class="pre">MessageBuilder</span></code> to write FLEX complex measurement routines that are stored in the B1500 and can be executed at a later point. This can be done to enable fast execution.</p>
</section>
</section>
<section id="Programming-Examples">
<h2>Programming Examples<a class="headerlink" href="#Programming-Examples" title="Link to this heading"></a></h2>
<section id="Initializing-the-instrument">
<h3>Initializing the instrument<a class="headerlink" href="#Initializing-the-instrument" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pyvisa.errors</span> <span class="kn">import</span> <span class="n">VisaIOError</span>

<span class="kn">import</span> <span class="nn">qcodes</span> <span class="k">as</span> <span class="nn">qc</span>
<span class="kn">from</span> <span class="nn">qcodes.dataset</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Measurement</span><span class="p">,</span>
    <span class="n">initialise_database</span><span class="p">,</span>
    <span class="n">load_or_create_experiment</span><span class="p">,</span>
    <span class="n">plot_dataset</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">qcodes.instrument_drivers.Keysight</span> <span class="kn">import</span> <span class="n">KeysightB1500</span>
<span class="kn">from</span> <span class="nn">qcodes.instrument_drivers.Keysight.keysightb1500</span> <span class="kn">import</span> <span class="n">MessageBuilder</span><span class="p">,</span> <span class="n">constants</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">Station</span><span class="p">()</span> <span class="c1"># Create a station to hold all the instruments</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Note: If there is no physical instrument connected</span>
<span class="c1">#the following code will try to load a simulated instrument</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1">#TODO change that address according to your setup</span>
    <span class="n">b1500</span> <span class="o">=</span> <span class="n">KeysightB1500</span><span class="p">(</span><span class="s1">&#39;spa&#39;</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="s1">&#39;GPIB21::17::INSTR&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;**Note: using physical instrument.**&quot;</span><span class="p">))</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">VisaIOError</span><span class="p">):</span>
    <span class="c1"># Either there is no VISA lib installed or there was no real instrument found at the</span>
    <span class="c1"># specified address =&gt; use simulated instrument</span>
    <span class="n">b1500</span> <span class="o">=</span> <span class="n">KeysightB1500</span><span class="p">(</span><span class="s1">&#39;SPA&#39;</span><span class="p">,</span>
                          <span class="n">address</span><span class="o">=</span><span class="s1">&#39;GPIB::1::INSTR&#39;</span><span class="p">,</span>
                          <span class="n">pyvisa_sim_file</span><span class="o">=</span><span class="s2">&quot;keysight_b1500.yaml&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;**Note: using simulated instrument. Functionality will be limited.**&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[spa(KeysightB1500)] Could not connect at GPIB21::17::INSTR
Traceback (most recent call last):
  File &#34;C:\Users\jenielse\source\repos\Qcodes\qcodes\instrument\visa.py&#34;, line 116, in _connect_and_handle_error
    visa_handle, visabackend = self._open_resource(address, visalib)
  File &#34;C:\Users\jenielse\source\repos\Qcodes\qcodes\instrument\visa.py&#34;, line 139, in _open_resource
    resource_manager = pyvisa.ResourceManager()
  File &#34;C:\Users\jenielse\Miniconda3\envs\qcodespip310\lib\site-packages\pyvisa\highlevel.py&#34;, line 2992, in __new__
    visa_library = open_visa_library(visa_library)
  File &#34;C:\Users\jenielse\Miniconda3\envs\qcodespip310\lib\site-packages\pyvisa\highlevel.py&#34;, line 2899, in open_visa_library
    wrapper = _get_default_wrapper()
  File &#34;C:\Users\jenielse\Miniconda3\envs\qcodespip310\lib\site-packages\pyvisa\highlevel.py&#34;, line 2858, in _get_default_wrapper
    raise ValueError(
ValueError: Could not locate a VISA implementation. Install either the IVI binary or pyvisa-py.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Connected to: Agilent Technologies B1500A (serial:0, firmware:A.04.03.2010.0130) in 0.11s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p><strong>Note: using simulated instrument. Functionality will be limited.</strong></p>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">b1500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;spa&#39;
</pre></div></div>
</div>
</section>
</section>
<section id="High-Level-Interface">
<h2>High Level Interface<a class="headerlink" href="#High-Level-Interface" title="Link to this heading"></a></h2>
<p>Here is an example of using high-level interface.</p>
<section id="Identifying-and-selecting-installed-modules">
<h3>Identifying and selecting installed modules<a class="headerlink" href="#Identifying-and-selecting-installed-modules" title="Link to this heading"></a></h3>
<p>As mentioned above, the B1500 is a modular instrument, and contains multiple cards. When initializing the driver, the driver requests the installed modules from the B1500 and exposes them to the user via multiple ways.</p>
<p>The first way to address a certain module is e.g. as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span> <span class="c1"># first SMU in the system</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span> <span class="c1"># first CMU in the system</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span> <span class="c1"># second SMU in the system</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">phase_compensation_mode</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The naming scheme is - <code class="docutils literal notranslate"><span class="pre">b1500.&lt;instrument</span> <span class="pre">class</span> <span class="pre">as</span> <span class="pre">lower</span> <span class="pre">case&gt;&lt;number&gt;</span></code>, where number is <code class="docutils literal notranslate"><span class="pre">1</span></code> for the first instrument in its class, <code class="docutils literal notranslate"><span class="pre">2</span></code> for the second instrument in its class and so on. (<em>Not the channel or slot number!</em>)</p>
<p>Next to this direct access - which is simple and good for direct user interaction - the modules are also exposed via multiple data structures through which they can be adressed: - by slot number - by module kind (such as SMU, or CMU) - by channel number</p>
<p>This can be more convenient for programmatic selection of the modules.</p>
<p>Instrument modules are installed in slots (numbered 1-11) and can be selected by the slot number:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">by_slot</span>
</pre></div>
</div>
</div>
<p>All modules are also grouped by module kind (see <code class="docutils literal notranslate"><span class="pre">constants.ModuleKind</span></code> for list of known kinds of modules):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">by_kind</span>
</pre></div>
</div>
</div>
<p>For example, let’s list all SMU modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">by_kind</span><span class="p">[</span><span class="s1">&#39;SMU&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Lastly, there is dictionary of all module channels:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For the simulation driver:</span>
<span class="c1"># Note how the B1530A module has two channels.</span>
<span class="c1"># The first channel number is the same as the slot number (6).</span>
<span class="c1"># The second channel has a `02` appended to the channel number.</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">by_channel</span>
</pre></div>
</div>
</div>
<p><strong>Note: For instruments with only one channel, channel number is the same as the slot number. However there are instruments with 2 channels per card. For these instruments the second channel number will differ from the slot number.</strong></p>
<p><strong>Note for the simulated instrument: The simulation driver will list a B1530A module with 2 channels as example.</strong></p>
<p>In general, the slot- and channel numbers can be passed as integers. However (especially in the case of the channel numbers for multi-channel instruments) it is recommended to use the Python enums defined in <code class="docutils literal notranslate"><span class="pre">qcodes.instrument_drivers.Keysight.keysightb1500.constants</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecting a module by channel number using the Enum</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">by_channel</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">ChNr</span><span class="o">.</span><span class="n">SLOT_01_CH1</span><span class="p">]</span>

<span class="c1"># Without enum</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">by_channel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># And we assert that we selected the same module:</span>
<span class="k">assert</span> <span class="n">m1</span> <span class="ow">is</span> <span class="n">m2</span>
</pre></div>
</div>
</div>
</section>
<section id="Enabling-/-Disabling-channels">
<h3>Enabling / Disabling channels<a class="headerlink" href="#Enabling-/-Disabling-channels" title="Link to this heading"></a></h3>
<p>Before sourcing or doing a measurement, the respective channel has to be enabled. There are two ways to enable/disable a channel: - By directly addressing the module - By addressing the mainframe and specifying which channel(s) to be enabled</p>
<p>The second method is useful if multiple channels shall be enabled, or for programmatic en-/disabling of channels. It also allows to en-/disable all channels with one call.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Direct addressing the module</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">disable_outputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enabling via the mainframe</span>

<span class="c1"># enable one channel</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">enable_channels</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># enable multiple channels</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">enable_channels</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># disable multiple channels</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">disable_channels</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># disable all channels</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">disable_channels</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Perform-self-calibration">
<h3>Perform self calibration<a class="headerlink" href="#Perform-self-calibration" title="Link to this heading"></a></h3>
<p>Calibration takes about 30 seconds (the visa timeout for it is controlled by <code class="docutils literal notranslate"><span class="pre">b1500.calibration_time_out</span></code> attribute).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">self_calibration</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Performing-sampling-measurements">
<h3>Performing sampling measurements<a class="headerlink" href="#Performing-sampling-measurements" title="Link to this heading"></a></h3>
<p>This section outlines steps to perform sampling measurement.</p>
<p>Set a sample rate and number of samples.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of spot measurments made per second and stored in a buffer.</span>
<span class="n">sample_rate</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="c1"># Total number of spot measurements.</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
<p>Assign timing parameters to SMU.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">timing_parameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Autozero is generally disabled for sampling measurement.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">autozero_enabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Set SMU to sampling mode.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">measurement_mode</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MM</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">SAMPLING</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>SMU is configured with by assigning voltage output range, input output range and compliance. While forcing voltage, current should be the compliance and vice versa.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">source_config</span><span class="p">(</span><span class="n">output_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">VOutputRange</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
                       <span class="n">compliance</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
                       <span class="n">compl_polarity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">min_compliance_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">IOutputRange</span><span class="o">.</span><span class="n">AUTO</span>
                      <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Set the averaging to 1 otherwise the measurement takes 10 times more time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">use_nplc_for_high_speed_adc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Set the voltage</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">voltage</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We are now ready to start the sampling measurement. We first initialize the database and create-new/load-old experiment. Then we register our dependent and independent parameters and start the measurement.</p>
<p><strong>Note</strong> that the default values of label and units are not defined for the parameter sampling measurement trace. Hence we first set them according to what is being measured: in this case we will measure current in A. It is important to set the label and the unit before the measurement in order to have this information when looking at the acquired data, for example when plotting it with <code class="docutils literal notranslate"><span class="pre">plot_dataset</span></code> as shown below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Current&#39;</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="c1"># Automatic assignment of the label and unit based on</span>
<span class="c1"># the settings of the instrument can be implemented</span>
<span class="c1"># upon request.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initialise_database</span><span class="p">()</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">load_or_create_experiment</span><span class="p">(</span><span class="n">experiment_name</span><span class="o">=</span><span class="s1">&#39;dummy_sampling_measurement&#39;</span><span class="p">,</span>
                          <span class="n">sample_name</span><span class="o">=</span><span class="s2">&quot;no sample&quot;</span><span class="p">)</span>
<span class="n">meas</span>  <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="p">)</span>

<span class="k">with</span> <span class="n">meas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">datasaver</span><span class="p">:</span>
    <span class="n">datasaver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="p">,</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<p>Thanks to the <code class="docutils literal notranslate"><span class="pre">label</span></code> and <code class="docutils literal notranslate"><span class="pre">unit</span></code> set above for the <code class="docutils literal notranslate"><span class="pre">sampling_measurement_trace</span></code> parameter, the <code class="docutils literal notranslate"><span class="pre">plot_dataset</span></code> function is able to produce a plot with a useful label for the vertical axis, see below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dataset</span><span class="p">(</span><span class="n">datasaver</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Check compliance: For the values which are compliant the output is one and for others it is zero. A quick to visualize of your measurements are compliant is to plot the compliance data and look if any value of zero.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_compliance</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">compliance</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_compliance</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Measurements&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Compliance status&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The channel number of the measured data can be obtained in the following way.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_channel</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">channel</span>
<span class="n">data_channel</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>If you want to know the type of the measured data, for ex ‘I’ or ‘V’ the following method can be used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_type</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">type</span>
<span class="n">data_type</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The measurement status can be obtained using:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_status</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">sampling_measurement_trace</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">status</span>
<span class="n">data_status</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The variable ‘data_status’ is a list of strings of measurement status for each data point. One can look at the meaning of the statuses in <code class="docutils literal notranslate"><span class="pre">constants.MeasurementStatus</span></code> class. It enlists meaning of all possible measurement status. For example: in case the measurement status is ‘C’ its meaning can be found as following.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constants</span><span class="o">.</span><span class="n">MeasurementStatus</span><span class="o">.</span><span class="n">N</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constants</span><span class="o">.</span><span class="n">MeasurementStatus</span><span class="o">.</span><span class="n">C</span>
</pre></div>
</div>
</div>
</section>
<section id="CV-Sweep">
<h3>CV Sweep<a class="headerlink" href="#CV-Sweep" title="Link to this heading"></a></h3>
<p>MFCMU has two modes of measurement. The first is spot measurement and this here is sweep measurement. As the name suggest sweep measurement execute the measurement once for the whole list of voltages and saves the output in the buffer untill measurment is completed.</p>
<p>The function below sets up properly the parameters to run the sweep measurements. Look at the docstring of <code class="docutils literal notranslate"><span class="pre">setup_staircase_cv</span></code> to know more about each argument of the function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">setup_staircase_cv</span><span class="p">(</span>
    <span class="n">v_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">v_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>
    <span class="n">freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span>
    <span class="n">ac_rms</span><span class="o">=</span><span class="mf">250e-3</span><span class="p">,</span>
    <span class="n">post_sweep_voltage_condition</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">WMDCV</span><span class="o">.</span><span class="n">Post</span><span class="o">.</span><span class="n">STOP</span><span class="p">,</span>
    <span class="n">adc_mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">ACT</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">PLC</span><span class="p">,</span>
    <span class="n">adc_coef</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">imp_model</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">IMP</span><span class="o">.</span><span class="n">MeasurementMode</span><span class="o">.</span><span class="n">Cp_D</span><span class="p">,</span>
    <span class="n">ranging_mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">RangingMode</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
    <span class="n">fixed_range_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">hold_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">step_delay</span><span class="o">=</span><span class="mf">225e-3</span><span class="p">,</span>
    <span class="n">trigger_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">measure_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">abort_enabled</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">Abort</span><span class="o">.</span><span class="n">ENABLED</span><span class="p">,</span>
    <span class="n">sweep_mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">SweepMode</span><span class="o">.</span><span class="n">LINEAR</span><span class="p">,</span>
    <span class="n">volt_monitor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If the setup function does not output any error then we are ready for the measurement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initialise_database</span><span class="p">()</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">load_or_create_experiment</span><span class="p">(</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s1">&#39;dummy_capacitance_measurement&#39;</span><span class="p">,</span>
    <span class="n">sample_name</span><span class="o">=</span><span class="s2">&quot;no sample&quot;</span>
<span class="p">)</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>

<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">run_sweep</span><span class="p">)</span>

<span class="k">with</span> <span class="n">meas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">datasaver</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">run_sweep</span><span class="p">()</span>
    <span class="n">datasaver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">run_sweep</span><span class="p">,</span><span class="n">res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Starting experimental run with id: 2330.
</pre></div></div>
</div>
<p>The ouput of the <code class="docutils literal notranslate"><span class="pre">run_sweep</span></code> is a primary parameter (Capacitance) and a secondary parameter (Dissipation). The type of primary and secondary parameter depends on the impedance model set in the <code class="docutils literal notranslate"><span class="pre">setup_staircase_cv</span></code> function (or via the corresponding <code class="docutils literal notranslate"><span class="pre">impedance_model</span></code> parameter). The setpoints of both the parameters are the same voltage values as defined by <code class="docutils literal notranslate"><span class="pre">setup_staircase_cv</span></code> (behind the scenes, those values are available in the <code class="docutils literal notranslate"><span class="pre">cv_sweep_voltages</span></code> parameter).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dataset</span><span class="p">(</span><span class="n">datasaver</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([&lt;matplotlib.axes._subplots.AxesSubplot at 0x1b18dff91d0&gt;,
  &lt;matplotlib.axes._subplots.AxesSubplot at 0x1b19173f860&gt;],
 [None, None])
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_70_1.png" src="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_70_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_70_2.png" src="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_70_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">run_sweep</span><span class="o">.</span><span class="n">status_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;parallel_capacitance&#39;: &#39;No status error occurred.&#39;,
 &#39;dissipation_factor&#39;: &#39;No status error occurred.&#39;}
</pre></div></div>
</div>
</section>
<section id="IV-Sweep">
<h3>IV Sweep<a class="headerlink" href="#IV-Sweep" title="Link to this heading"></a></h3>
<p>This section explains the IV Staircase sweep measurements.</p>
<p>Enable the channels.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Always good to do for the safety of the measured sample</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">voltage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">voltage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Setting up smu1 and smu2 for running the staircase sweep. One of the smu’s is used for sweep. Both the smu’s are used for acquiring data. It is possible to acquire data with more SMUs, that depends on the measurement mode (see below), so refer to the instrument manual for information on how many ‘channels’ can be measured with which measurement mode. In the setup below, smu1 is used to sweep over the sweep voltages -3 to 3 in 201 steps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">setup_staircase_sweep</span><span class="p">(</span>
    <span class="n">v_src_range</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">VOutputRange</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
    <span class="n">v_start</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">v_end</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">201</span><span class="p">,</span>
    <span class="n">av_coef</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">step_delay</span> <span class="o">=</span> <span class="mf">0.225</span><span class="p">,</span>
    <span class="n">abort_enabled</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">Abort</span><span class="o">.</span><span class="n">ENABLED</span><span class="p">,</span>
    <span class="n">i_meas_range</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">IMeasRange</span><span class="o">.</span><span class="n">FIX_10nA</span><span class="p">,</span>
    <span class="n">i_comp</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
    <span class="n">sweep_mode</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SweepMode</span><span class="o">.</span><span class="n">LINEAR</span><span class="p">,</span>
    <span class="c1"># and there are more arguments with default values</span>
    <span class="c1"># that might need to be changed for your</span>
    <span class="c1"># particular measurement situation</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">smu2</span></code> is kept at constant voltage and at different compliance and measurement range settings.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">voltage</span><span class="p">(</span><span class="mf">10e-3</span><span class="p">)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">enable_filter</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">measurement_operation_mode</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">CMM</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">COMPLIANCE_SIDE</span><span class="p">)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">current_measurement_range</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">IMeasRange</span><span class="o">.</span><span class="n">FIX_10uA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">b1500.set_measurement_mode</span></code> is used to define measurement mode and the channels from which data is extracted from. Here, channels correspond to SMU1 and SMU2 respectively - the SMU which is setup to run the sweep needs to go <strong>FIRST</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">set_measurement_mode</span><span class="p">(</span>
    <span class="n">mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">MM</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">STAIRCASE_SWEEP</span><span class="p">,</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">)</span>
<span class="c1"># SMUs have only one channel so using `channels[0]` is enough</span>
<span class="c1"># This might be improved in the future for better clarity and user convenience.</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">run_iv_staircase_sweep</span></code> is used to run the sweep</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initialise_database</span><span class="p">()</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">load_or_create_experiment</span><span class="p">(</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s1">&#39;dummy_iv_sweep_measurement&#39;</span><span class="p">,</span>
    <span class="n">sample_name</span><span class="o">=</span><span class="s2">&quot;no sample&quot;</span>
<span class="p">)</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># As per user needs, names and labels of the parameters inside the</span>
<span class="c1"># MultiParameter can be adjusted to reflect what is actually being</span>
<span class="c1"># measured using the convenient `set_names_labels_and_units` method.</span>
<span class="c1"># The setpoint name/label/unit (the independent sweep &#39;parameter&#39;)</span>
<span class="c1"># can be additionally customized using `set_setpoint_name_label_and_unit`</span>
<span class="c1"># method.</span>
<span class="c1"># Below is an example of using `set_names_labels_and_units`:</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">run_iv_staircase_sweep</span><span class="o">.</span><span class="n">set_names_labels_and_units</span><span class="p">(</span>
    <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;gate_current&#39;</span><span class="p">,</span> <span class="s1">&#39;source_drain_current&#39;</span><span class="p">),</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Gate current&#39;</span><span class="p">,</span> <span class="s1">&#39;Source-drain current&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="c1"># The number of names (and labels) MUST be the same as the number of channels,</span>
<span class="c1"># and the order of the names should match the order of channels, as passed to</span>
<span class="c1"># `set_measurement_mode` method.</span>

<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">b1500</span><span class="o">.</span><span class="n">run_iv_staircase_sweep</span><span class="p">)</span>

<span class="k">with</span> <span class="n">meas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">datasaver</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">run_iv_staircase_sweep</span><span class="p">()</span>
    <span class="n">datasaver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">b1500</span><span class="o">.</span><span class="n">run_iv_staircase_sweep</span><span class="p">,</span> <span class="n">res</span><span class="p">))</span>

<span class="c1"># In production code, remeber to revert the names/labels of the</span>
<span class="c1"># run_iv_staircase_sweep MultiParameter in order to avoid confusion.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Starting experimental run with id: 2329.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dataset</span><span class="p">(</span><span class="n">datasaver</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([&lt;matplotlib.axes._subplots.AxesSubplot at 0x1b18df955c0&gt;,
  &lt;matplotlib.axes._subplots.AxesSubplot at 0x1b1915cd160&gt;],
 [None, None])
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_85_1.png" src="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_85_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_85_2.png" src="../../_images/examples_driver_examples_Qcodes_example_with_Keysight_B1500_Parameter_Analyzer_85_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">run_iv_staircase_sweep</span><span class="o">.</span><span class="n">status_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;gate_current&#39;: &#39;No status error occurred.&#39;,
 &#39;source_drain_current&#39;: &#39;No status error occurred.&#39;}
</pre></div></div>
</div>
</section>
<section id="Performing-phase-compensation">
<h3>Performing phase compensation<a class="headerlink" href="#Performing-phase-compensation" title="Link to this heading"></a></h3>
<p>The phase compensation is performed to adjust the phase zero.</p>
<p>One must take care of two things before executing the phase compensation. First, make sure that all the channel outputs are enabled else instrument throws an error.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">run_iv_staircase_sweep</span><span class="o">.</span><span class="n">measurement_status</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Second, the phase compensation mode must be set to manual.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">phase_compensation_mode</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">ADJ</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">MANUAL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now the phase compensation can be performed as follows. This operation takes about 30 seconds (the visa timeout for this operation is set via <code class="docutils literal notranslate"><span class="pre">b1500.cmu1.phase_compensation_timeout</span></code> attribute).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">phase_compensation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">phase_compensation</span></code> method also supports loading data of previously performed phase compensation. To use that, explicitly pass the operation mode argument:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">phase_compensation</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">ADJQuery</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">USE_LAST</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Performing-Open/Short/Load-correction">
<h3>Performing Open/Short/Load correction<a class="headerlink" href="#Performing-Open/Short/Load-correction" title="Link to this heading"></a></h3>
<section id="Set-and-get-reference-values">
<h4>Set and get reference values<a class="headerlink" href="#Set-and-get-reference-values" title="Link to this heading"></a></h4>
<p>Use the following method to set the calibration values or reference values of the open/short/load standard. Here, we are using open correction with Cp-G mode. The primary reference value, which is the value for Cp (in F), is set to 0.00001, and the secondary reference value, which is the value of G (in S), is set to 0.00002. These values are completely arbitrary, so please change them according to your experiments.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">set_reference_values</span><span class="p">(</span><span class="n">corr</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">CalibrationType</span><span class="o">.</span><span class="n">OPEN</span><span class="p">,</span>
                                           <span class="n">mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">DCORR</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">Cp_G</span><span class="p">,</span>
                                           <span class="n">primary</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">,</span>
                                           <span class="n">secondary</span><span class="o">=</span><span class="mf">0.00002</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can retrieve the values you have set for calibration or the reference values of the open/short/load standard in the following way:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">get_reference_values</span><span class="p">(</span><span class="n">corr</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">CalibrationType</span><span class="o">.</span><span class="n">OPEN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Add-CMU-output-frequency-to-the-list-for-correction">
<h4>Add CMU output frequency to the list for correction<a class="headerlink" href="#Add-CMU-output-frequency-to-the-list-for-correction" title="Link to this heading"></a></h4>
<p>You can add to the list of frequencies supported by the instrument to be used for the data correction. The frequency value can be given with a certain resolution as per Table 4-18 in the programming manual.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">frequency_list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Clear-CMU-output-frequency-list">
<h4>Clear CMU output frequency list<a class="headerlink" href="#Clear-CMU-output-frequency-list" title="Link to this heading"></a></h4>
<p>Clear the frequency list for the correction data measurement using the following methods. Correction data will be invalid after calls to these methods, so you will have to again perform the open/short/load correction.</p>
<p>There are two modes in which you can clear the frequency list. First is clearing the list of frequencies:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">frequency_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Second is clearing the list of frequencies and also setting it to a default list of frequencies (for the list of default frequencies, refer to the documentation of the <code class="docutils literal notranslate"><span class="pre">CLCORR</span></code> command in the programming manual):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">frequency_list</span><span class="o">.</span><span class="n">clear_and_set_default</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Query-CMU-output-frequency-list">
<h4>Query CMU output frequency list<a class="headerlink" href="#Query-CMU-output-frequency-list" title="Link to this heading"></a></h4>
<p>It is possible to query the total number of frequencies in the list:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">frequency_list</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>It is also possible to query the values of specific frequencies using the same method by specifying an index within the frequency list:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">frequency_list</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Open/Short/Load-Correction">
<h4>Open/Short/Load Correction<a class="headerlink" href="#Open/Short/Load-Correction" title="Link to this heading"></a></h4>
<p>As per description in the programming guide, we first set the oscillator level of the CMU output signal.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set oscillator level</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">voltage_ac</span><span class="p">(</span><span class="mf">30e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To perform open/short/load correction connect the open/short/load standard and execute the following command to perform and enable the correction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">perform_and_enable</span><span class="p">(</span><span class="n">corr</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">CalibrationType</span><span class="o">.</span><span class="n">OPEN</span><span class="p">)</span>
<span class="c1">#b1500.cmu1.correction.perform_and_enable(corr=constants.CalibrationType.SHORT)</span>
<span class="c1">#b1500.cmu1.correction.perform_and_enable(corr=constants.CalibrationType.LOAD)</span>
</pre></div>
</div>
</div>
<p>In case you would only like to perform the correction but not enable it, you can use separate methods <code class="docutils literal notranslate"><span class="pre">perform</span></code> and <code class="docutils literal notranslate"><span class="pre">enable</span></code>.</p>
<p>To check whether a correction is enabled, use the following method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">(</span><span class="n">corr</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">CalibrationType</span><span class="o">.</span><span class="n">OPEN</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To disable a performed correction, use the following method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">cmu1</span><span class="o">.</span><span class="n">correction</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">corr</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">CalibrationType</span><span class="o">.</span><span class="n">OPEN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="SMU-sourcing-and-measuring">
<h3>SMU sourcing and measuring<a class="headerlink" href="#SMU-sourcing-and-measuring" title="Link to this heading"></a></h3>
<p>The simplest measurement one can do with the B1500 are <em>High Speed Spot Measurements</em>. They work independent of the selected <em>Measurement Mode</em>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">voltage</span></code> and <code class="docutils literal notranslate"><span class="pre">current</span></code> Qcodes Parameters that the SMU High Level driver exposes will execute <em>High Speed Spot</em> measurements. Additionally, there are functions that let the user specify the output/measure ranges, and compliance limits.</p>
<p>To source a voltage/current do the following: 1. Configure source range, and (optionally) compliance settings 2. Enable the channel 3. Force the desired voltage 4. (optionally) Disable the channel</p>
<p><strong>Note: The source settings (Step 1) are persistent until changed again. So for sucessive measurements the configuration can be omitted.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>

<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">source_config</span><span class="p">(</span><span class="n">output_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">VOutputRange</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
                         <span class="n">compliance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">voltage</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To measure do the following: 1. Configure the voltage or/and current measure ranges 2. Enable the channel (if not yet enabled) 3. Do the measurement 4. (optionally) Disable the channel</p>
<p><strong>Note: The measure settings (Step 1) are persistent until changed again. So for sucessive measurements the configuration can be omitted.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">i_measure_range_config</span><span class="p">(</span><span class="n">i_measure_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">IMeasRange</span><span class="o">.</span><span class="n">MIN_100mA</span><span class="p">)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">v_measure_range_config</span><span class="p">(</span><span class="n">v_measure_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">VMeasRange</span><span class="o">.</span><span class="n">FIX_2V</span><span class="p">)</span>

<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">enable_outputs</span><span class="p">()</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
<span class="n">vol</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">voltage</span><span class="p">()</span>

<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">disable_outputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Setting-up-ADCs-to-NPLC-mode">
<h3>Setting up ADCs to NPLC mode<a class="headerlink" href="#Setting-up-ADCs-to-NPLC-mode" title="Link to this heading"></a></h3>
<p>Both the mainframe driver and SMU driver implement convenience methods for controlling integration time of the <em>High Speed Spot</em> measurement, which allow setting ADC type, and setting the frequenty used NPLC mode.</p>
<p>Use the following methods on the mainframe instance to set up the ADCs to NPLC mode:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the high-speed ADC to NPLC mode,</span>
<span class="c1"># and optionally specify the number of PLCs as an arugment</span>
<span class="c1"># (refer to the docstring and the user manual for more information)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">use_nplc_for_high_speed_adc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set the high-resolution ADC to NPLC mode,</span>
<span class="c1"># and optionally specify the number of PLCs as an arugment</span>
<span class="c1"># (refer to the docstring and the user manual for more information)</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">use_nplc_for_high_resolution_adc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And then use the following methods on the SMU instances to use particular ADC for the particular SMU:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use high-speed ADC</span>
<span class="c1"># with the settings defined above</span>
<span class="c1"># for the SMU 1</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu1</span><span class="o">.</span><span class="n">use_high_speed_adc</span><span class="p">()</span>

<span class="c1"># Use high-resoultion ADC</span>
<span class="c1"># with the settings defined above</span>
<span class="c1"># for the SMU 2</span>
<span class="n">b1500</span><span class="o">.</span><span class="n">smu2</span><span class="o">.</span><span class="n">use_high_resolution_adc</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Error-Message">
<h2>Error Message<a class="headerlink" href="#Error-Message" title="Link to this heading"></a></h2>
<p>The error messages from the instrument can be read using the following method. This method reads one error code from the head of the error queue and removes that code from the queue. The read error is returned as the response of this method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1500</span><span class="o">.</span><span class="n">error_message</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Here, the response message contains an error number and an error message. In some cases the error message may also contain the additional information such as the slot number. They are separated by a semicolon (;). For example, if the error 305 occurs on the slot 1, this method returns the following response. 305,”Excess current in HPSMU.; SLOT1”</p>
<p>If no error occurred, this command returns 0,”No Error”.</p>
</section>
<section id="Low-Level-Interface">
<h2>Low Level Interface<a class="headerlink" href="#Low-Level-Interface" title="Link to this heading"></a></h2>
<p>The Low Level Interface provides a wrapper around the FLEX command set. Multiple commands can be assembled in a sequence. Finally, the command sequence is compiled into a command string, which then can be sent to the instrument.</p>
<p>Only some very minimal checks are done to the command string. For example some commands have to be the <em>last</em> command in a sequence of commands because the fill the output queue. Adding additional commands after that is not allowed.</p>
<p>As an example, a “voltage source + current measurement” is done, similar as was done above with the high level interface.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mb</span> <span class="o">=</span> <span class="n">MessageBuilder</span><span class="p">()</span>

<span class="n">mb</span><span class="o">.</span><span class="n">cn</span><span class="p">(</span><span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">mb</span><span class="o">.</span><span class="n">dv</span><span class="p">(</span><span class="n">chnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
      <span class="n">voltage</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
      <span class="n">v_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">VOutputRange</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
      <span class="n">i_comp</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">mb</span><span class="o">.</span><span class="n">ti</span><span class="p">(</span><span class="n">chnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
      <span class="n">i_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">IMeasRange</span><span class="o">.</span><span class="n">FIX_100uA</span><span class="p">)</span>
<span class="n">mb</span><span class="o">.</span><span class="n">cl</span><span class="p">(</span><span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Compiles the sequence of FLEX commands into a message string.</span>
<span class="n">message_string</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">message_string</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The message string can be sent to the instrument. To parse the response of this spot measurement command, use the <code class="docutils literal notranslate"><span class="pre">KeysightB1500.parse_spot_measurement_response</span></code> static method.</p>
<p><code class="docutils literal notranslate"><span class="pre">parse_spot_measurement_response</span></code> will return a <code class="docutils literal notranslate"><span class="pre">dict</span></code> that contains the measurement value together with the measurement channel, info on what was measured (current, voltage, capacitance, …), and status information. For a detailed description, see the user manual.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">message_string</span><span class="p">)</span>

<span class="n">KeysightB1500</span><span class="o">.</span><span class="n">parse_spot_measurement_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MessageBuilder</span></code> object can be cleared, which allows the object to be reused to generate a new message string.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mb</span><span class="o">.</span><span class="n">clear_message_queue</span><span class="p">()</span>
<span class="c1"># This will produce empty string because MessageBuilder buffer was cleared</span>
<span class="n">mb</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MessageBuilder</span></code> provides a <em>fluent</em> interface, which means every call on the <code class="docutils literal notranslate"><span class="pre">MessageBuilder</span></code> object always returns the object itself, with the exeption of <code class="docutils literal notranslate"><span class="pre">MessageBuilder.message</span></code> which <strong>returns the compiled message string</strong>.</p>
<p>This means that the same message as in the first example could’ve been assembled like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">b1500</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span>
    <span class="n">MessageBuilder</span><span class="p">()</span>
    <span class="o">.</span><span class="n">cn</span><span class="p">(</span><span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="o">.</span><span class="n">dv</span><span class="p">(</span>
        <span class="n">chnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">voltage</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">v_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">VOutputRange</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
        <span class="n">i_comp</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">ti</span><span class="p">(</span><span class="n">chnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i_range</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">IMeasRange</span><span class="o">.</span><span class="n">FIX_100uA</span><span class="p">)</span>
    <span class="o">.</span><span class="n">cl</span><span class="p">(</span><span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="o">.</span><span class="n">message</span>
<span class="p">)</span>

<span class="n">KeysightB1500</span><span class="o">.</span><span class="n">parse_spot_measurement_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Qcodes%20example%20with%20Keysight%2034980A%20Switch%20Mainframe%20and%20Modules.html" class="btn btn-neutral float-left" title="QCoDeS Example with Keysight 34980A Multifunction Switch / Measure Mainframe and Modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Qcodes%20example%20with%20Keysight%20B2200%20Series%20Femto%20Leakage%20Switch%20Matrix.html" class="btn btn-neutral float-right" title="QCoDeS Example with Keysight B2200 Series Femto Leakage Switch Matrix" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>