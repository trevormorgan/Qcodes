<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/png" sizes="310x346" href="../../_static/qcodes_favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QCoDeS Example with Mercury iPS &mdash; QCoDeS 0.27.0.dev9139 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=9e84aeb3"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="QCoDeS Example with Oxford Triton" href="Qcodes%20example%20with%20Oxford%20Triton.html" />
    <link rel="prev" title="QCoDeS Example with Minicircuits Switch Boxes Controlled via USB" href="Qcodes%20example%20with%20Minicircuits%20Switch%20boxes%20%28USB-XSPDT%29.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            QCoDeS
          </a>
              <div class="version">
                0.27.0.dev9139+main.g009ec80fb
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../15_minutes_to_QCoDeS.html">15 minutes to QCoDeS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples of using QCoDeS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-examples">Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#dataset">DataSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotting">Plotting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#drivers">Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20Example%20with%20Keysight%20E4980A%20LCR%20meter.html">QCoDeS Example with Keysight E4980A LCR meter</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20Example%20with%20Yokogawa%20GS200%20and%20Keithley%207510.html">QCoDeS Example with Yokogawa GS200 and Keithley 7510 Multimeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20Aim%20TTi%20PL601-P.html">QCoDeS example with Aim TTi PL601-P</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20DelegateInstrument.html">Qcodes example with DelegateInstrument driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20Galil%20DMC4133%20Controller.html">QCoDeS example with Galil DMC4133 Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20InstrumentGroup%20and%20DelegateInstrument.html">Qcodes example with InstrumentGroup driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCoDeS%20example%20with%20Keithley%203706A%20System%20Switch.html">QCoDeS example with Keithley 3706A System Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes%20example%20with%20Keithley%20S46.html">QCoDeS Example with Tektronix Keithley S46</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes%20example%20with%20Rigol%20DG1062.html">QCoDeS Example with the Rigol DG 1062 Instrument</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes%20example%20with%20Tektronix%20DPO%2072004C.html">QCoDeS example with Textronix DPO 7200xx scopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20AMI430.html">QCoDeS Example with AMI430</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Agilent%2034400A.html">QCoDeS Example with Agilent 34400A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Alazar%20ATS9360.html">QCoDeS Example with Alazar ATS 9360</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Basel%20SP983c%20Preamp.html">Qcodes example with Basel SP983c Preamp and its Remote SP983a</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Cryomagnetics4G.html">Cryomagnetics 4G QCoDeS Driver Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20DynaCool%20PPMS.html">QCoDeS Example with DynaCool PPMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20HP8753D.html">QCoDeS Example with HP8753D</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Ithaco.html">QCoDeS Example with Itacho</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keithley%202600.html">QCoDeS Example with with Keithley 2600 series</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keithley%207510.html">QCoDeS Example with Tektronix Keithley 7510 Multimeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%2033500B.html">QCoDeS Example with Keysight 33500B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20344xxA.html">QCoDeS Example with Keysight 344xxA</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%2034980A%20Switch%20Mainframe%20and%20Modules.html">QCoDeS Example with Keysight 34980A Multifunction Switch / Measure Mainframe and Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20B1500%20Parameter%20Analyzer.html">Qcodes example with Keysight B1500 Semiconductor Parameter Analyzer</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20B2200%20Series%20Femto%20Leakage%20Switch%20Matrix.html">QCoDeS Example with Keysight B2200 Series Femto Leakage Switch Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20Infiniium%20Oscilloscope.html">QCoDeS Example with Keysight Infiniium Oscilloscopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20N9030B.html">Qcodes example with Keysight N9030B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Keysight%20Network%20Analyzer.html">QCoDeS Example with Keysight Network Analyzers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Lakeshore%20325.html">QCoDeS Example with Lakeshore 325</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Lakeshore%20336%20or%20372%20-%20Bluefors%20T%20control.html">QCoDeS Example with the Lakeshore Model 372 to Control the Temperature of the Bluefors Fridge</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Minicircuits%20Switch%20boxes%20%28USB-XSPDT%29.html">QCoDeS Example with Minicircuits Switch Boxes Controlled via USB</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">QCoDeS Example with Mercury iPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initial-instantiation/connection">Initial instantiation/connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Basic-driver-idea">Basic driver idea</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Safe-regions">Safe regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Two-different-ramps">Two different ramps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Parameter-overview">Parameter overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Ramp-examples">Ramp examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Oxford%20Triton.html">QCoDeS Example with Oxford Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20QDev_QDac.html">QCoDeS Example with QDac_channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rigol%20DP832.html">QCoDeS Example with Rigol DP832 Power Supply</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rigol%20DS1074Z.html">QCoDeS Example with the Rigol DS 1074 Z oscilloscope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rohde%20Schwarz%20RTO%201000%20series%20Oscilloscope.html">QCoDeS Example with Rohde Schwarz RTO 1000 Series Oscilloscope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rohde%20Schwarz%20SGS100A.html">QCoDeS Example with Rohde Schwarz SGS100A RF source</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Rohde%20Schwarz%20ZNB.html">QCoDeS Example with Rohde Schwarz ZNB20/8</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Stahl.html">QCoDeS Example with the Stahl Bias Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Stanford%20SR830.html">QCoDeS Example with Stanford SR830</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Stanford%20SR86x%20with%20buffered%20readout.html">QCoDeS Example with Standford Research SR86x Lock-in Amplifier with Buffered Readout</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Tektronix%20AWG5014C.html">QCoDeS Example with Tektronix AWG5014</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Tektronix%20AWG70002A.html">QCoDeS Example with Tektronix AWG70002A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Tektronix%20TPS2012.html">QCoDeS Example with Tektronix TPS2012</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20Yokogawa%20GS2xx.html">QCoDeS Example with Yokogawa GS200/GS210</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%20example%20with%20keithley%202450.html">QCoDeS Example with Tektronix Keithley 2450 Source Meter</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes%2Bbroadbean%20example%20with%20Tektronix%20AWG5208.html">QCoDeS+Broadbean Example with Tektronix AWG5208</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes-example-with-Signal-Hound-USB-SA124B.html">QCoDeS Example with Signal Hound USB-SA124B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes-example-with-Signal-Hound-USB-SA124B-ParameterWithSetpoints.html">QCoDeS Example with Signal Hound USB-SA124B ParameterWithSetpoints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#writing-drivers">Writing Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#logging">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">QCoDes API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers_api/index.html">Instrument Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Get Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QCoDeS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Examples of using QCoDeS</a></li>
      <li class="breadcrumb-item active">QCoDeS Example with Mercury iPS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/driver_examples/Qcodes example with Oxford Mercury iPS.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
  <p>This page was generated from
    <a class="reference external"
    href="https://github.com/qcodes/qcodes/blob/main/docs/examples/driver_examples/Qcodes example with Oxford Mercury iPS.ipynb">docs/examples/driver_examples/Qcodes example with Oxford Mercury iPS.ipynb</a>.
    Interactive online version:
    <a href="https://mybinder.org/v2/gh/qcodes/qcodes/main?filepath=docs/examples/driver_examples/Qcodes example with Oxford Mercury iPS.ipynb"><img
alt="Binder badge"
    src="https://mybinder.org/badge_logo.svg"
    style="vertical-align:text-bottom"></a>.
  </p>
  <script>
    if (document.location.host) {
      var p = document.currentScript.previousSibling.previousSibling;
      var a = document.createElement('a');
      a.innerHTML = 'View in <em>nbviewer</em>';
      a.href = `https://nbviewer.jupyter.org/url${
        (window.location.protocol == 'https:' ? 's/' : '/') +
        window.location.host +
        window.location.pathname.slice(0, -4) }ipynb`;
      a.classList.add('reference');
      a.classList.add('external');
      p.appendChild(a);
      p.appendChild(document.createTextNode('.'));
    }
  </script>
</div><section id="QCoDeS-Example-with-Mercury-iPS">
<h1>QCoDeS Example with Mercury iPS<a class="headerlink" href="#QCoDeS-Example-with-Mercury-iPS" title="Link to this heading"></a></h1>
<section id="Initial-instantiation/connection">
<h2>Initial instantiation/connection<a class="headerlink" href="#Initial-instantiation/connection" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="kn">from</span> <span class="nn">qcodes.instrument_drivers.oxford</span> <span class="kn">import</span> <span class="n">OxfordMercuryiPS</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the MercuryiPS_VISA is a VISA instrument using</span>
<span class="c1"># a socket connection. The VISA resource name therefore</span>
<span class="c1"># contains the port number and the word &#39;SOCKET&#39;</span>
<span class="n">mips</span> <span class="o">=</span> <span class="n">OxfordMercuryiPS</span><span class="p">(</span><span class="s1">&#39;mips&#39;</span><span class="p">,</span> <span class="s1">&#39;TCPIP0::192.168.15.106::7020::SOCKET&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Connected to: OXFORD INSTRUMENTS MERCURY IPS (serial:170150002, firmware:2.6.04.000) in 0.15s
</pre></div></div>
</div>
</section>
<section id="Basic-driver-idea">
<h2>Basic driver idea<a class="headerlink" href="#Basic-driver-idea" title="Link to this heading"></a></h2>
<p>The driver mainly deals with <strong>field values</strong> in Tesla. The driver is aware of the field values in three coordinate systems, cartesian, spherical, and cylindrical. The driver thus exposes the field coordinates x, y, z, phi, theta, rho, and r. Each coordinate comes in two versions: <strong>target</strong> and <strong>measured</strong>.</p>
<p>The idea is that the magnetic field is always changed in two steps; first a target is set, then the magnet is asked to ramp to said target.</p>
</section>
<section id="Safe-regions">
<h2>Safe regions<a class="headerlink" href="#Safe-regions" title="Link to this heading"></a></h2>
<p>In addition to the safety limits baked in to the physical instrument, the driver can accept a safety limit function provided by the user. The function checks - upon receiving a new field target - whether the target is inside an allowed region.</p>
<p>The limit function must take input arguments Bx, By, Bz (in Tesla) and return a boolean that tells us whether that field value is safe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example: the safe region is a sphere</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">spherical_limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Safe region is a sphere of radius 1 T</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>


<span class="c1"># assign the limit function (this can also be done at init)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">set_new_field_limits</span><span class="p">(</span><span class="n">spherical_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Two-different-ramps">
<h2>Two different ramps<a class="headerlink" href="#Two-different-ramps" title="Link to this heading"></a></h2>
<p>The driver can perfom the ramp in two different ways: <em>simultaneous</em> ramping or <em>safe</em> ramping.</p>
<p>When simultaneously ramping, all three field components are ramped at the same time. This method is non-blocking, and it is thus possible to query the field while it is ramping. The method does, however, <strong>not</strong> guarantee that the field stays inside the allowed region during the ramp. If the different axes have different ramp speeds, this is a real risk.</p>
<p>When safely ramping, all field components that are ramped <em>towards</em> the origin are ramped before those who are ramped <em>away from</em> the origin. The ramp is thus sequential and blocking, but if the safe region is convex (and contains the origin), you are guaranteed the the field never exceeds the safe region.</p>
</section>
<section id="Parameter-overview">
<h2>Parameter overview<a class="headerlink" href="#Parameter-overview" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mips</span><span class="o">.</span><span class="n">print_readable_snapshot</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mips:
        parameter     value
--------------------------------------------------------------------------------
IDN            :        {&#39;model&#39;: &#39;MERCURY IPS&#39;, &#39;vendor&#39;: &#39;OXFORD INSTRUMENTS&#39;, &#39;se...
phi_measured   :        -0 (T)
phi_target     :        0 (degres)
r_measured     :        0.1 (T)
r_target       :        0.1 (T)
rho_measured   :        0.1 (T)
rho_target     :        0.1 (T)
theta_measured :        90 (T)
theta_target   :        90 (degrees)
timeout        :        5 (s)
x_measured     :        0.1 (T)
x_target       :        0.1 (T)
y_measured     :        -0 (T)
y_target       :        0 (T)
z_measured     :        -0 (T)
z_target       :        -0 (T)
mips_GRPX:
        parameter         value
--------------------------------------------------------------------------------
ATOB               :    59.451 (A/T)
current            :    5.945 (A)
current_persistent :    5.945 (A)
current_ramp_rate  :    0.59451 (A/s)
current_target     :    0 (A)
field              :    0.1 (T)
field_persistent   :    0.1 (T)
field_ramp_rate    :    0.01 (T/s)
field_target       :    0 (T)
ramp_status        :    TO SET
voltage            :    0.0023 (V)
mips_GRPY:
        parameter         value
--------------------------------------------------------------------------------
ATOB               :    59.301 (A/T)
current            :    -0.0005 (A)
current_persistent :    -0.0005 (A)
current_ramp_rate  :    0.59301 (A/s)
current_target     :    0 (A)
field              :    -0 (T)
field_persistent   :    -0 (T)
field_ramp_rate    :    0.01 (T/s)
field_target       :    0 (T)
ramp_status        :    HOLD
voltage            :    -0.0002 (V)
mips_GRPZ:
        parameter         value
--------------------------------------------------------------------------------
ATOB               :    18.168 (A/T)
current            :    0.0002 (A)
current_persistent :    0.0002 (A)
current_ramp_rate  :    0.18168 (A/s)
current_target     :    0 (A)
field              :    0 (T)
field_persistent   :    0 (T)
field_ramp_rate    :    0.01 (T/s)
field_target       :    0 (T)
ramp_status        :    HOLD
voltage            :    0.0003 (V)
</pre></div></div>
</div>
</section>
<section id="Ramp-examples">
<h2>Ramp examples<a class="headerlink" href="#Ramp-examples" title="Link to this heading"></a></h2>
<section id="First-example:-invalid-targets">
<h3>First example: invalid targets<a class="headerlink" href="#First-example:-invalid-targets" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mips</span><span class="o">.</span><span class="n">x_target</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># so far, so good</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">mips</span><span class="o">.</span><span class="n">y_target</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># this takes us out of the unit sphere</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can not set that&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Can not set that
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reset and try in a different coordinate system</span>
<span class="n">mips</span><span class="o">.</span><span class="n">x_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">mips</span><span class="o">.</span><span class="n">r_target</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can not set that&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Can not set that
</pre></div></div>
</div>
</section>
<section id="Second-example:-simul-ramps-to-the-origin">
<h3>Second example: simul ramps to the origin<a class="headerlink" href="#Second-example:-simul-ramps-to-the-origin" title="Link to this heading"></a></h3>
<p>First we ramp the field to Bx = 1, By = 0, Bz = 0, then rotate out to thea=46, phi=30, then finally ramp it down to zero while measuring r, theta, and phi.</p>
<section id="STEP-A">
<h4>STEP A<a class="headerlink" href="#STEP-A" title="Link to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mips</span><span class="o">.</span><span class="n">GRPX</span><span class="o">.</span><span class="n">field_ramp_rate</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">GRPY</span><span class="o">.</span><span class="n">field_ramp_rate</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">GRPZ</span><span class="o">.</span><span class="n">field_ramp_rate</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">x_target</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">y_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">z_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">ramp</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;simul&#39;</span><span class="p">)</span>

<span class="c1"># since simul mode is non-blocking,</span>
<span class="c1"># we can read out during the ramp</span>
<span class="k">while</span> <span class="n">mips</span><span class="o">.</span><span class="n">is_ramping</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ramping X to </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">x_target</span><span class="p">()</span><span class="si">}</span><span class="s1"> T, now at </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">x_measured</span><span class="p">()</span><span class="si">}</span><span class="s1"> T&#39;</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Done ramping, now at </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">x_measured</span><span class="p">()</span><span class="si">}</span><span class="s1"> T&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ramping X to 0.1 T, now at 0.1 T
Ramping X to 0.1 T, now at 0.1 T
Done ramping, now at 0.1 T
</pre></div></div>
</div>
</section>
<section id="STEP-B">
<h4>STEP B<a class="headerlink" href="#STEP-B" title="Link to this heading"></a></h4>
<p>Note that since the magnet itself has no notion of any other coordinate system than cartesian coordinates, it does <strong>NOT</strong> follow a path where r is constant. The user must <strong>MANUALLY</strong> ensure to break up a ramp where r is meant to be constant into sufficiently many small steps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mips</span><span class="o">.</span><span class="n">theta_target</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">phi_target</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">r_target</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">ramp</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;simul&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">mips</span><span class="o">.</span><span class="n">is_ramping</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ramping... r: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">r_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> T, &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;theta: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">theta_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;phi: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">phi_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done... r: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">r_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> T, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;theta: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">theta_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;phi: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">phi_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ramping... r: 0.100000 T, theta: 90.00, phi: -0.00
Ramping... r: 0.100000 T, theta: 90.00, phi: 0.00
Ramping... r: 0.099000 T, theta: 90.00, phi: 0.00
Ramping... r: 0.084369 T, theta: 82.86, phi: 11.52
Ramping... r: 0.076622 T, theta: 75.26, phi: 20.29
Ramping... r: 0.077474 T, theta: 67.38, phi: 27.21
Ramping... r: 0.080937 T, theta: 61.35, phi: 28.87
Ramping... r: 0.087963 T, theta: 53.60, phi: 29.53
Ramping... r: 0.093565 T, theta: 49.15, phi: 29.83
Ramping... r: 0.097914 T, theta: 46.26, phi: 29.94
Ramping... r: 0.099167 T, theta: 45.51, phi: 29.94
Ramping... r: 0.099729 T, theta: 45.14, phi: 29.98
Ramping... r: 0.099809 T, theta: 45.06, phi: 29.98
Ramping... r: 0.099915 T, theta: 45.04, phi: 30.05
Ramping... r: 0.099985 T, theta: 45.00, phi: 30.05
Done... r: 0.099985 T, theta: 45.00, phi: 30.05
</pre></div></div>
</div>
</section>
<section id="STEP-C">
<h4>STEP C<a class="headerlink" href="#STEP-C" title="Link to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mips</span><span class="o">.</span><span class="n">theta_target</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">phi_target</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">r_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">ramp</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;simul&#39;</span><span class="p">)</span>

<span class="c1"># since simul mode is non-blocking,</span>
<span class="c1"># we can read out during the ramp</span>
<span class="k">while</span> <span class="n">mips</span><span class="o">.</span><span class="n">is_ramping</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ramping... r: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">r_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> T, &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;theta: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">theta_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;phi: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">phi_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done... r: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">r_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> T, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;theta: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">theta_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;phi: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">phi_measured</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ramping... r: 0.099985 T, theta: 45.00, phi: 30.05
Ramping... r: 0.099985 T, theta: 45.00, phi: 30.05
Ramping... r: 0.099985 T, theta: 45.00, phi: 30.05
Ramping... r: 0.079511 T, theta: 36.45, phi: 25.40
Ramping... r: 0.060216 T, theta: 31.76, phi: 17.06
Ramping... r: 0.045938 T, theta: 27.09, phi: 8.25
Ramping... r: 0.033194 T, theta: 18.38, phi: 6.58
Ramping... r: 0.021813 T, theta: 8.91, phi: 9.46
Ramping... r: 0.009555 T, theta: 6.13, phi: 11.31
Ramping... r: 0.002929 T, theta: 8.09, phi: 14.04
Ramping... r: 0.001315 T, theta: 8.75, phi: 0.00
Ramping... r: 0.000608 T, theta: 9.46, phi: 0.00
Ramping... r: 0.000200 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000100 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000100 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 180.00
Ramping... r: 0.000100 T, theta: 180.00, phi: -180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 180.00
Ramping... r: 0.000100 T, theta: 180.00, phi: 180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 180.00
Ramping... r: 0.000100 T, theta: 180.00, phi: 180.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: -0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 0.00
Ramping... r: 0.000000 T, theta: 0.00, phi: 180.00
Done... r: 0.000000 T, theta: 0.00, phi: 0.00
</pre></div></div>
</div>
</section>
</section>
<section id="Third-example:-safe-ramp-away-from-the-origin">
<h3>Third example: safe ramp away from the origin<a class="headerlink" href="#Third-example:-safe-ramp-away-from-the-origin" title="Link to this heading"></a></h3>
<p>At the origin, we can not meaningfully <strong>measure</strong> what theta and phi is, but the target values are persistent.</p>
<p>If we ramp up again and measure, we should thus get back to our target values. We use blocking safe ramp for this (just to also test/show a blocking ramp).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mips</span><span class="o">.</span><span class="n">r_target</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">ramp</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;safe&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ramped back out again.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Field values are: theta: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">theta_measured</span><span class="p">()</span><span class="si">}</span><span class="s1">, phi: </span><span class="si">{</span><span class="n">mips</span><span class="o">.</span><span class="n">phi_measured</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ramped back out again.
Field values are: theta: 44.95982350797425, phi: 30.046435246810503
</pre></div></div>
</div>
</section>
<section id="That's-it-for-now!-Happy-sweeping.">
<h3>That’s it for now! Happy sweeping.<a class="headerlink" href="#That's-it-for-now!-Happy-sweeping." title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sweep back down for good measures</span>
<span class="n">mips</span><span class="o">.</span><span class="n">x_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">y_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mips</span><span class="o">.</span><span class="n">z_target</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">ramp</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;safe&#39;</span><span class="p">)</span>

<span class="n">mips</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Qcodes%20example%20with%20Minicircuits%20Switch%20boxes%20%28USB-XSPDT%29.html" class="btn btn-neutral float-left" title="QCoDeS Example with Minicircuits Switch Boxes Controlled via USB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Qcodes%20example%20with%20Oxford%20Triton.html" class="btn btn-neutral float-right" title="QCoDeS Example with Oxford Triton" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>